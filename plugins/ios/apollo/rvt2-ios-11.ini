; AUTOMATICALLY GENERATED FROM THE APOLLO PROJECT USING apollo2rvt2.py
; https://github.com/mac4n6/APOLLO.git

[FileParser.ios.powerlog_audio_routing]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_audio_routing.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Power Log Audio Output (ie: Speaker/CarAudioOutput/HeadphonesBT) of different categories (ie: Audio/Video, VoiceCommand, MediaPlayback).
query = 
	SELECT
	DATETIME(AUDIOROUTE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	ACTIVEROUTE,
	CASE ACTIVE
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END "ACTIVE",
	ACTIVEPID AS "ACTIVE PID",
	OUTPUTCATEGORY AS "OUTPUT CATEGORY",
	HEADSETHASINPUT AS "HEADSET HAS INPUT",
	HEADPHONESCONNECTED AS "HEADPHONES CONNECTED",
	DATETIME(AUDIOROUTE_TIMESTAMP, 'unixepoch') AS ORIGINAL_AUDIOROUTE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	AUDIOROUTE_ID AS "PLAUDIOAGENT_EVENTFORWARD_ROUTING TABLE ID"
	FROM
	(
	SELECT
	AUDIOROUTE_ID,
	AUDIOROUTE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	ACTIVEROUTE,
	ACTIVE,
	ACTIVEPID,
	OUTPUTCATEGORY,
	HEADSETHASINPUT,
	HEADPHONESCONNECTED,
	SYSTEM
	FROM
	(
	SELECT
	PLAUDIOAGENT_EVENTFORWARD_ROUTING.TIMESTAMP AS AUDIOROUTE_TIMESTAMP,
	ACTIVEROUTE,
	ACTIVE,
	ACTIVEPID,
	OUTPUTCATEGORY,
	HEADSETHASINPUT,
	HEADPHONESCONNECTED,
	PLAUDIOAGENT_EVENTFORWARD_ROUTING.ID AS "AUDIOROUTE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLAUDIOAGENT_EVENTFORWARD_ROUTING
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS AUDIOROUTE_STATE
	GROUP BY
	AUDIOROUTE_ID
	)

[FileParser.ios.powerlog_mobilebackup]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_mobilebackup.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	DATETIME(START, 'unixepoch') AS "START",
	DATETIME(END, 'unixepoch') AS "END",
	STATE as "STATE",
	FINISHED as "FINISHED",
	HASERROR AS "HAS ERROR",
	ID AS "PLXPCAGENT_EVENTPOINT_MOBILEBACKUPEVENTS TABLE ID"
	FROM
	PLXPCAGENT_EVENTPOINT_MOBILEBACKUPEVENTS

[FileParser.ios.knowledge_app_calendar_activity]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_app_calendar_activity.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Calendar intents and activity, shows context.
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "BUNDLE ID",
	ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__ACTIVITYTYPE AS "ACTIVITY TYPE",
	ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__TITLE AS "TITLE",
	DATETIME(ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__EXPIRATIONDATE + 978307200, 'UNIXEPOCH') AS "EXPIRATION DATE",
	DATETIME(ZSTRUCTUREDMETADATA.ZCOM_APPLE_CALENDARUIKIT_USERACTIVITY_DATE + 978307200, 'UNIXEPOCH') AS "CALENDAR DATE",
	DATETIME(ZSTRUCTUREDMETADATA.ZCOM_APPLE_CALENDARUIKIT_USERACTIVITY_ENDDATE + 978307200, 'UNIXEPOCH') AS "CALENDAR END DATE",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE + 978307200, 'UNIXEPOCH') AS "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME IS "/app/activity"
	AND ZVALUESTRING = "com.apple.mobilecal"

[FileParser.ios.routined_local_learned_location_of_interest_entry]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_learned_location_of_interest_entry.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Location of Interest Entry (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "ENTRY",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "EXIT",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE AS "LOI LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "LOI LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZCONFIDENCE,
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONUNCERTAINTY,
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZDATAPOINTCOUNT,
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "PLACE CREATION DATE",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "EXPIRATION",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONLATITUDE AS "VISIT LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONLONGITUDE AS "VISIT LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.Z_PK AS "ZRTLEARNEDLOCATIONOFINTERESTVISITMO TABLE ID"
	FROM
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO
	LEFT JOIN
	ZRTLEARNEDLOCATIONOFINTERESTMO
	ON ZRTLEARNEDLOCATIONOFINTERESTMO.Z_PK = ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONOFINTEREST

[FileParser.ios.health_heart_rate]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_heart_rate.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Heart Rate
query = 
	SELECT
	ORIGINAL_QUANTITY AS "HEART RATE",
	UNIT_STRINGS.UNIT_STRING as "UNITS",
	QUANTITY AS "QUANTITY",
	DATETIME(SAMPLES.START_DATE + 978307200, 'unixepoch') AS "DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	QUANTITY_SAMPLES
	ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	LEFT OUTER JOIN
	UNIT_STRINGS
	ON QUANTITY_SAMPLES.ORIGINAL_UNIT = UNIT_STRINGS.ROWID
	WHERE
	SAMPLES.DATA_TYPE = 5

[FileParser.ios.routined_cloud_visit_entry]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_entry.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Vist Entry (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE

[FileParser.ios.call_history]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/call_history.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Call History
query = 
	SELECT
	CAST(ZADDRESS AS TEXT) AS "ADDRESS",
	ZANSWERED AS "WAS ANSWERED",
	ZCALLTYPE AS "CALL TYPE",
	ZORIGINATED AS "ORIGINATED",
	ZDURATION AS "DURATION (IN SECONDS)",
	ZISO_COUNTRY_CODE as "ISO COUNTY CODE",
	ZLOCATION AS "LOCATION",
	ZSERVICE_PROVIDER AS "SERVICE PROVIDER",
	DATETIME(ZDATE+978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM ZCALLRECORD

[FileParser.ios.knowledge_device_batterylevel]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_batterylevel.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Device battery level percentage.
query = 
	SELECT
	ZOBJECT.ZVALUEDOUBLE as "BATTERY LEVEL",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME LIKE "/device/BatteryPercentage"

[FileParser.ios.knowledge_audio_input_route]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_audio_input_route.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Audio Input
query = 
	SELECT
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__IDENTIFIER AS "AUDIO IDENTIFIER",
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__PORTNAME AS "AUDIO PORT NAME",
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__PORTTYPE AS "AUDIO PORT TYPE",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME = "/audio/inputRoute"

[FileParser.ios.sms_chat_message_delivered]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/sms_chat_message_delivered.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = SMS and Chat Messages, when the message was delivered.
query = 
	SELECT
	CASE
	WHEN LENGTH(MESSAGE.DATE)=18 THEN DATETIME(MESSAGE.DATE/1000000000+978307200,'UNIXEPOCH')
	WHEN LENGTH(MESSAGE.DATE)=9 THEN DATETIME(MESSAGE.DATE + 978307200,'UNIXEPOCH')
	ELSE "N/A"
	END "DATE",
	CASE
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=18 THEN DATETIME(MESSAGE.DATE_DELIVERED/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=9 THEN DATETIME(MESSAGE.DATE_DELIVERED+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE DELIVERED",
	CASE
	WHEN LENGTH(MESSAGE.DATE_READ)=18 THEN DATETIME(MESSAGE.DATE_READ/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_READ)=9 THEN DATETIME(MESSAGE.DATE_READ+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE READ",
	MESSAGE.TEXT as "MESSAGE",
	HANDLE.ID AS "CONTACT ID",
	MESSAGE.SERVICE AS "SERVICE",
	MESSAGE.ACCOUNT AS "ACCOUNT",
	MESSAGE.IS_DELIVERED AS "IS DELIVERED",
	MESSAGE.IS_FROM_ME AS "IS FROM ME",
	ATTACHMENT.FILENAME AS "FILENAME",
	ATTACHMENT.MIME_TYPE AS "MIME TYPE",
	ATTACHMENT.TRANSFER_NAME AS "TRANSFER TYPE",
	ATTACHMENT.TOTAL_BYTES AS "TOTAL BYTES"
	FROM MESSAGE
	LEFT OUTER JOIN MESSAGE_ATTACHMENT_JOIN ON MESSAGE.ROWID = MESSAGE_ATTACHMENT_JOIN.MESSAGE_ID
	LEFT OUTER JOIN ATTACHMENT ON MESSAGE_ATTACHMENT_JOIN.ATTACHMENT_ID = ATTACHMENT.ROWID
	LEFT OUTER JOIN HANDLE ON MESSAGE.HANDLE_ID = HANDLE.ROWID
	WHERE "DATE DELIVERED" IS NOT "N/A"

[FileParser.ios.powerlog_device_telephony_registration]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_telephony_registration.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Records telephony registration details such as carrier and service.
query = 
	SELECT
	DATETIME(TELEPHONYREG_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	DATAIND AS "SERVICE",
	OPERATOR AS "OPERATOR",
	STATUS AS "STATUS",
	CELLID AS "CELL ID",
	DATAACTIVE AS "DATA ACTIVE",
	DATAATTACHED AS "DATA ATTACHED",
	HOME AS "HOME",
	LAC AS "LAC",
	DATETIME(TELEPHONYREG_TIMESTAMP, 'unixepoch') AS ORIGINAL_TELEPHONYREG_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	TELEPHONYREG_ID AS "PLBBAGENT_EVENTFORWARD_TELEPHONYREGISTRATION TABLE ID"
	FROM
	(
	SELECT
	TELEPHONYREG_ID,
	TELEPHONYREG_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	DATAIND,
	OPERATOR,
	STATUS,
	CELLID,
	DATAACTIVE,
	DATAATTACHED,
	HOME,
	LAC,
	SYSTEM
	FROM
	(
	SELECT
	PLBBAGENT_EVENTFORWARD_TELEPHONYREGISTRATION.TIMESTAMP AS TELEPHONYREG_TIMESTAMP,
	DATAIND,
	OPERATOR,
	STATUS,
	CELLID,
	DATAACTIVE,
	DATAATTACHED,
	HOME,
	LAC,
	PLBBAGENT_EVENTFORWARD_TELEPHONYREGISTRATION.ID AS "TELEPHONYREG_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLBBAGENT_EVENTFORWARD_TELEPHONYREGISTRATION
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS TELEPHONYREG_STATE
	GROUP BY
	TELEPHONYREG_ID
	)

[FileParser.ios.knowledge_device_locked]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_locked.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Is the deviced locked or unlocked.
query = 
	SELECT
	CASE ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'UNLOCKED'
	WHEN '1' THEN 'LOCKED'
	END "IS LOCKED",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME LIKE "/device/isLocked"

[FileParser.ios.powerlog_springboard_aggregate_bulletins]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_springboard_aggregate_bulletins.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	BULLETINBUNDLEID AS "BULLETIN BUNDLE ID",
	TIMEINTERVAL / 60 AS "TIME INTERVAL IN SECONDS",
	COUNT AS "COUNT",
	POSTTYPE AS "POST TYPE",
	ID AS "PLSPRINGBOARDAGENT_AGGREGATE_SBBULLETINS_AGGREGATE TABLE ID"
	FROM
	PLSPRINGBOARDAGENT_AGGREGATE_SBBULLETINS_AGGREGATE

[FileParser.ios.routined_local_learned_location_of_interest_exit]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_learned_location_of_interest_exit.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Location of Interest Exit (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "ENTRY",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "EXIT",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE AS "LOI LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "LOI LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZCONFIDENCE,
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONUNCERTAINTY,
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZDATAPOINTCOUNT,
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "PLACE CREATION DATE",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "EXPIRATION",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONLATITUDE AS "VISIT LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONLONGITUDE AS "VISIT LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO.Z_PK AS "ZRTLEARNEDLOCATIONOFINTERESTVISITMO TABLE ID"
	FROM
	ZRTLEARNEDLOCATIONOFINTERESTVISITMO
	LEFT JOIN
	ZRTLEARNEDLOCATIONOFINTERESTMO
	ON ZRTLEARNEDLOCATIONOFINTERESTMO.Z_PK = ZRTLEARNEDLOCATIONOFINTERESTVISITMO.ZLOCATIONOFINTEREST

[FileParser.ios.aggregate_dictionary_distributed_keys]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/aggregate_dictionary_distributed_keys.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Keeping track of various values on a per-day basis.
query = 
	SELECT
	DISTRIBUTIONKEYS.KEY AS "KEY",
	DISTRIBUTIONVALUES.VALUE AS "VALUE",
	DISTRIBUTIONVALUES.SECONDSINDAYOFFSET AS "SECONDS IN DAY OFFSET",
	DATE(DISTRIBUTIONKEYS.DAYSSINCE1970*86400, 'unixepoch') AS "DAY",
	DISTRIBUTIONVALUES.DISTRIBUTIONID AS "DISTRIBUTIONVALUES TABLE ID"
	FROM
	DISTRIBUTIONKEYS
	LEFT JOIN
	DISTRIBUTIONVALUES
	ON DISTRIBUTIONKEYS.ROWID = DISTRIBUTIONVALUES.DISTRIBUTIONID

[FileParser.ios.powerlog_display_brightness]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_display_brightness.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Screen Brightness Percentage
query = 
	SELECT
	DATETIME(BRIGHTNESS_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BRIGHTNESS,
	DATETIME(BRIGHTNESS_TIMESTAMP, 'unixepoch') AS ORIGINAL_BRIGHTNESS_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	BRIGHTNESS_ID AS "PLDISPLAYAGENT_EVENTFORWARD_DISPLAY TABLE ID"
	FROM
	(
	SELECT
	BRIGHTNESS_ID,
	BRIGHTNESS_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	BRIGHTNESS,
	SYSTEM
	FROM
	(
	SELECT
	PLDISPLAYAGENT_EVENTFORWARD_DISPLAY.TIMESTAMP AS BRIGHTNESS_TIMESTAMP,
	BRIGHTNESS,
	PLDISPLAYAGENT_EVENTFORWARD_DISPLAY.ID AS "BRIGHTNESS_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLDISPLAYAGENT_EVENTFORWARD_DISPLAY
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS BRIGHTNESS_STATE
	GROUP BY
	BRIGHTNESS_ID
	)

[FileParser.ios.health_workout_elevation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_elevation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Elevation
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.NUMERICAL_VALUE/100.00 AS "ELEVATION (IN METERS)",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "_HKPrivateWorkoutElevationAscendedQuantity"

[FileParser.ios.powerlog_incallservice]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_incallservice.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Provides calling service details and status.
query = 
	SELECT
	DATETIME(INCALLSERVICE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BUNDLEID AS "BUNDLE ID",
	KCALLSUBTYPE AS "KCALL SUB TYPE",
	PROVIDERIDENTIFIER AS "PROVIDER IDENTIFIER",
	STATUS,
	VIDEO,
	DATETIME(INCALLSERVICE_TIMESTAMP, 'unixepoch') AS ORIGINAL_INCALLSERVICE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	INCALLSERVICE_ID AS "PLXPCAGENT_EVENTFORWARD_INCALLSERVICE TABLE ID"
	FROM
	(
	SELECT
	INCALLSERVICE_ID,
	INCALLSERVICE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	BUNDLEID,
	KCALLSUBTYPE,
	PROVIDERIDENTIFIER,
	STATUS,
	VIDEO,
	SYSTEM
	FROM
	(
	SELECT
	PLXPCAGENT_EVENTFORWARD_INCALLSERVICE.TIMESTAMP AS INCALLSERVICE_TIMESTAMP,
	BUNDLEID,
	KCALLSUBTYPE,
	PROVIDERIDENTIFIER,
	STATUS,
	VIDEO,
	PLXPCAGENT_EVENTFORWARD_INCALLSERVICE.ID AS "INCALLSERVICE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLXPCAGENT_EVENTFORWARD_INCALLSERVICE
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	WHERE
	INCALLSERVICE_TIMESTAMP > TIME_OFFSET_TIMESTAMP
	)
	AS INCALLSERVICE_STATE
	GROUP BY
	INCALLSERVICE_ID
	)

[FileParser.ios.powerlog_springboard_aggregate_notifications]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_springboard_aggregate_notifications.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	NOTIFICATIONBUNDLEID AS "BULLETIN BUNDLE ID",
	TIMEINTERVAL / 60 AS "TIME INTERVAL IN SECONDS",
	COUNT AS "COUNT",
	NOTIFICATIONTYPE AS "NOTIFICATION TYPE",
	ID AS "PLSPRINGBOARDAGENT_AGGREGATE_SBNOTIFICATIONS_AGGREGATE TABLE ID"
	FROM
	PLSPRINGBOARDAGENT_AGGREGATE_SBNOTIFICATIONS_AGGREGATE

[FileParser.ios.powerlog_battery_level]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_battery_level.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	LEVEL AS "LEVEL",
	RAWLEVEL AS "RAW LEVEL",
	ISCHARGING AS "IS CHARGING",
	FULLYCHARGED AS "FULLY CHARGED",
	ID AS "PLBATTERYAGENT_EVENTBACKWARD_BATTERY TABLE ID"
	FROM
	PLBATTERYAGENT_EVENTBACKWARD_BATTERY

[FileParser.ios.datausage_zprocess]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/datausage_zprocess.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Data Usage Processes/Bundle IDs.
query = 
	SELECT
	DATETIME(ZPROCESS.ZTIMESTAMP+ 978307200, 'unixepoch') AS "TIMESTAMP",
	DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
	ZPROCESS.ZPROCNAME AS "PROCESS NAME",
	ZPROCESS.ZBUNDLENAME AS "BUNDLE ID",
	ZPROCESS.Z_PK AS "ZPROCESS TABLE ID"
	FROM ZPROCESS

[FileParser.ios.powerlog_video]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_video.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Which app is playing a video.
query = 
	SELECT
	DATETIME(VIDEO_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	CLIENTDISPLAYID AS "CLIENT DISPLAY ID",
	STATE,
	CLIENTPID AS "CLIENT PID",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	VIDEO_ID AS "PLVIDEOAGENT_EVENTFORWARD_VIDEO TABLE ID"
	FROM
	(
	SELECT
	VIDEO_ID,
	VIDEO_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	CLIENTDISPLAYID,
	STATE,
	CLIENTPID,
	SYSTEM
	FROM
	(
	SELECT
	PLVIDEOAGENT_EVENTFORWARD_VIDEO.TIMESTAMP AS VIDEO_TIMESTAMP,
	CLIENTDISPLAYID,
	STATE,
	CLIENTPID,
	PLVIDEOAGENT_EVENTFORWARD_VIDEO.ID AS "VIDEO_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLVIDEOAGENT_EVENTFORWARD_VIDEO
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS VIDEO_STATE
	GROUP BY
	VIDEO_ID
	)

[FileParser.ios.powerlog_button_state]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_button_state.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	BUTTONTYPE AS "BUTTON TYPE",
	EVENTTYPE AS "EVENT TYPE",
	ID AS "PLBUTTONAGENT_EVENTPOINT_BUTTONTABLE TABLE ID"
	FROM
	PLBUTTONAGENT_EVENTPOINT_BUTTON

[FileParser.ios.powerlog_timezone]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_timezone.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Keeping track of the timezone.
query = 
	SELECT
	DATETIME(TIMEZONE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	TIMEZONENAME AS "TIME ZONE NAME",
	COUNTRYCODE AS "COUNTRY CODE",
	LOCALEID AS "LOCALE ID",
	SECONDSFROMGMT / 3600 AS "SECONDS FROM GMT",
	TIMEZONEISINDST AS "TIME ZONE IN DST",
	TRIGGER AS "TRIGGER",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	TIMEZONE_ID AS "PLLOCALEAGENT_EVENTFORWARD_TIMEZONE TABLE ID"
	FROM
	(
	SELECT
	TIMEZONE_ID,
	TIMEZONE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	TIMEZONENAME,
	COUNTRYCODE,
	LOCALEID,
	SECONDSFROMGMT,
	TIMEZONEISINDST,
	TRIGGER,
	SYSTEM
	FROM
	(
	SELECT
	PLLOCALEAGENT_EVENTFORWARD_TIMEZONE.TIMESTAMP AS TIMEZONE_TIMESTAMP,
	TIMEZONENAME,
	COUNTRYCODE,
	LOCALEID,
	SECONDSFROMGMT,
	TIMEZONEISINDST,
	TRIGGER,
	PLLOCALEAGENT_EVENTFORWARD_TIMEZONE.ID AS "TIMEZONE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLLOCALEAGENT_EVENTFORWARD_TIMEZONE
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS TIMEZONE_STATE
	GROUP BY
	TIMEZONE_ID
	)

[FileParser.ios.safari_history]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/safari_history.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Safari Browsing
query = 
	SELECT
	HISTORY_ITEMS.URL AS "URL",
	HISTORY_ITEMS.VISIT_COUNT AS "VISIT COUNT",
	HISTORY_VISITS.TITLE AS "TITLE",
	CASE HISTORY_VISITS.ORIGIN
	WHEN 1 THEN "ICLOUD SYNCED DEVICE"
	WHEN 0 THEN "VISTED FROM THIS DEVICE"
	END "ICLOUD SYNC",
	HISTORY_VISITS.LOAD_SUCCESSFUL AS "LOAD SUCCESSFUL",
	HISTORY_VISITS.REDIRECT_SOURCE AS "REDIRECT SOURCE",
	HISTORY_VISITS.REDIRECT_DESTINATION AS "REDIRECT DESTINATION",
	DATETIME(HISTORY_VISITS.VISIT_TIME+978307200,'UNIXEPOCH') AS "VISIT TIME",
	HISTORY_VISITS.ID AS "HISTORY ITEM ID"
	FROM HISTORY_ITEMS
	LEFT OUTER JOIN HISTORY_VISITS ON HISTORY_ITEMS.ID == HISTORY_VISITS.HISTORY_ITEM

[FileParser.ios.powerlog_app_nowplaying]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_nowplaying.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = What app/service is playing something, or not.
query = 
	SELECT
	DATETIME(NOWPLAYING_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BUNDLEID AS "BUNDLE ID",
	CASE STATE
	WHEN "0" THEN "OFF"
	WHEN "1" THEN "ON"
	END AS "STATE",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	NOWPLAYING_ID AS "PLAUDIOAGENT_EVENTFORWARD_NOWPLAYING TABLE ID"
	FROM
	(
	SELECT
	NOWPLAYING_ID,
	NOWPLAYING_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	BUNDLEID,
	STATE,
	SYSTEM
	FROM
	(
	SELECT
	PLAUDIOAGENT_EVENTFORWARD_NOWPLAYING.TIMESTAMP AS NOWPLAYING_TIMESTAMP,
	BUNDLEID,
	STATE,
	PLAUDIOAGENT_EVENTFORWARD_NOWPLAYING.ID AS "NOWPLAYING_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLAUDIOAGENT_EVENTFORWARD_NOWPLAYING
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS NOWPLAYING_STATE
	GROUP BY
	NOWPLAYING_ID
	)

[FileParser.ios.routined_cloud_visit_exit]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_exit.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Vist Exit (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE

[FileParser.ios.knowledge_app_inFocus]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_app_inFocus.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Application Usage, shows application in focus on device.
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "BUNDLE ID",
	(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE) as "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM ZOBJECT
	WHERE ZSTREAMNAME IS "/app/inFocus"

[FileParser.ios.powerlog_device_telephony_activity]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_telephony_activity.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	AIRPLANEMODE AS "AIRPLANE MODE",
	CALLSTATUS AS "CALL STATUS",
	SIGNALBARS AS "SIGNALS BARS",
	SIGNALSTRENGTH AS "SIGNAL STRENGTH",
	CAMPEDRAT AS "CAMPED RAT",
	CURRENTRAT AS "CURRENT RAT",
	PREFERREDRAT AS "PREFERRED RAT",
	ACTIVEBAND AS "ACTIVE BAND",
	DATASTATUS AS "DATA STATUS",
	SIMSTATUS AS "SIM STATUS",
	ID AS "PLBBAGENT_EVENTPOINT_TELEPHONYACTIVITY TABLE ID"
	FROM
	PLBBAGENT_EVENTPOINT_TELEPHONYACTIVITY

[FileParser.ios.locationd_cacheencryptedC_stepcounthistory]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedC_stepcounthistory.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Step Count History
query = 
	SELECT
	DATETIME(STARTTIME + 978307200, 'UNIXEPOCH') AS "START TIME",
	TIMESTAMP AS "MOVEMENT TIME",
	COUNT AS "COUNT",
	DISTANCE AS "DISTANCE",
	RAWDISTANCE AS "RAWDISTANCE",
	FLOORSASCENDED AS "FLOORS ASCENDED",
	FLOORSDESCENDED AS "FLOORS DESCENDED",
	PACE AS "PACE",
	ACTIVETIME AS "ACTIVE TIME",
	FIRSTSTEPTIME AS "FIRST STEP TIME",
	PUSHCOUNT AS "PUSH COUNT",
	WORKOUTTYPE AS "WORKOUT TYPE",
	STEPCOUNTHISTORY.ID AS "STEPCOUNTHISTORY TABLE ID"
	FROM STEPCOUNTHISTORY

[FileParser.ios.locationd_cacheencryptedAB_scdmacelllocation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_scdmacelllocation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd SCDMA Cell Location
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	MNC AS "MNC",
	LAC AS "LAC",
	CI AS "CI",
	UARFCN AS "UARFCN",
	PSC AS "PSC",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM SCDMACELLLOCATION

[FileParser.ios.knowledge_device_is_backlit]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_is_backlit.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Is the device screen backlit or not.
query = 
	SELECT
	CASE ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'NO'
	WHEN '1' THEN 'YES'
	END "SCREEN IS BACKLIT",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME is "/display/isBacklit"

[FileParser.ios.powerlog_process_data_usage]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_process_data_usage.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS "TIMESTAMP",
	DATETIME(TIMESTAMPEND, 'unixepoch') AS "TIMESTAMP END",
	BUNDLENAME AS "BUNDLE ID",
	PROCESSNAME AS "PROCESS NAME",
	CELLIN AS "CELLULAR IN",
	CELLOUT AS "CELLULAR OUT",
	WIFIIN AS "WIFI IN",
	WIFIOUT AS "WIFI OUT",
	ID AS "PLPROCESSNETWORKAGENT_EVENTINTERVAL_USAGEDIFF TABLE ID"
	FROM
	PLPROCESSNETWORKAGENT_EVENTINTERVAL_USAGEDIFF

[FileParser.ios.powerlog_paired_device_config]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_paired_device_config.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	BUILD,
	DEVICE,
	HWMODEL,
	PAIRINGID AS "PAIRING ID",
	ID AS "PLCONFIGAGENT_EVENTNONE_PAIREDDEVICECONFIG TABLE ID"
	FROM
	PLCONFIGAGENT_EVENTNONE_PAIREDDEVICECONFIG

[FileParser.ios.powerlog_app_usage]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_usage.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Application/Device screen state/orientation
query = 
	SELECT
	DATETIME(SCREEN_STATE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BUNDLEID AS BUNDLE_ID,
	APPROLE,
	DISPLAY,
	LEVEL,
	ORIENTATION,
	SCREENWEIGHT,
	DATETIME(SCREEN_STATE_TIMESTAMP, 'unixepoch') AS ORIGINAL_SCREEN_STATE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	SCREENSTATE_ID AS "PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE TABLE ID"
	FROM
	(
	SELECT
	BUNDLEID,
	SCREENSTATE_ID,
	SCREEN_STATE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) as max_id,
	SYSTEM,
	APPROLE,
	DISPLAY,
	LEVEL,
	ORIENTATION,
	SCREENWEIGHT
	FROM
	(
	SELECT
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.APPROLE AS APPROLE,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.DISPLAY AS DISPLAY,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.LEVEL AS LEVEL,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.ORIENTATION AS ORIENTATION,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.SCREENWEIGHT AS SCREENWEIGHT,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.ID AS SCREENSTATE_ID,
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE.TIMESTAMP AS SCREEN_STATE_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM,
	BUNDLEID
	FROM
	PLSCREENSTATEAGENT_EVENTFORWARD_SCREENSTATE
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS SCREENSTATE
	GROUP BY
	SCREENSTATE_ID
	)

[FileParser.ios.netusage_zliveusage]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/netusage_zliveusage.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Network Usage Traffic by Process.
query = 
	SELECT
	DATETIME(ZPROCESS.ZTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS TIMESTAMP",
	DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
	DATETIME(ZLIVEUSAGE.ZTIMESTAMP + 978307200, 'unixepoch') AS "LIVE USAGE TIMESTAMP",
	ZBUNDLENAME AS "BUNDLE ID",
	ZPROCNAME AS "PROCESS NAME",
	ZWIFIIN AS "WIFI IN",
	ZWIFIOUT AS "WIFI OUT",
	ZWWANIN AS "WWAN IN",
	ZWWANOUT AS "WWAN OUT",
	ZWIREDIN AS "WIRED IN",
	ZWIREDOUT AS "WIRED OUT",
	ZXIN AS "X IN",
	ZXOUT AS "X OUT",
	ZLIVEUSAGE.Z_PK AS "ZLIVEUSAGE TABLE ID"
	FROM ZLIVEUSAGE
	LEFT JOIN ZPROCESS ON ZPROCESS.Z_PK = ZLIVEUSAGE.ZHASPROCESS

[FileParser.ios.powerlog_app_audio]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_audio.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Audio Routing via App
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	DATETIME(TIMESTAMPLOGGED, 'unixepoch') AS "TIMESTAMP LOGGED",
	APPLICATIONNAME AS "APPLICATION NAME / BUNDLE ID",
	ASSERTIONID AS "ASERTION ID",
	ASSERTIONNAME AS "ASSERTION NAME",
	AUDIOROUTE AS "AUDIO ROUTE",
	MIRRORINGSTATE AS "MIRRORING STATE",
	OPERATION,
	PID,
	ID AS "PLAUDIOAGENT_EVENTPOINT_AUDIOAPP TABLE ID"
	FROM
	PLAUDIOAGENT_EVENTPOINT_AUDIOAPP

[FileParser.ios.health_flights]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_flights.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Flights Climbed
query = 
	SELECT
	QUANTITY AS "FLIGHTS CLIMBED",
	DATETIME(SAMPLES.START_DATE + 978307200, 'unixepoch') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'unixepoch') AS "END DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	QUANTITY_SAMPLES
	ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	WHERE
	SAMPLES.DATA_TYPE = 12

[FileParser.ios.interaction_contact_interactions]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/interaction_contact_interactions.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	ZINTERACTIONS.ZBUNDLEID,
	ZCONTACTS.ZDISPLAYNAME,
	ZCONTACTS.ZIDENTIFIER,
	ZCONTACTS.ZPERSONID,
	ZINTERACTIONS.ZDIRECTION,
	ZINTERACTIONS.ZISRESPONSE,
	ZINTERACTIONS.ZMECHANISM,
	ZINTERACTIONS.ZRECIPIENTCOUNT,
	DATETIME(ZINTERACTIONS.ZCREATIONDATE + 978307200, 'unixepoch') AS "ZINTERACTIONS CREATION DATE",
	DATETIME(ZCONTACTS.ZCREATIONDATE + 978307200, 'unixepoch') AS "ZCONTACTS CREATION DATE",
	DATETIME(ZINTERACTIONS.ZSTARTDATE + 978307200, 'unixepoch') AS "START DATE",
	DATETIME(ZINTERACTIONS.ZENDDATE + 978307200, 'unixepoch') AS "END DATE",
	DATETIME(ZCONTACTS.ZFIRSTINCOMINGRECIPIENTDATE + 978307200, 'unixepoch') AS "FIRST INCOMING RECIPIENT DATE",
	DATETIME(ZCONTACTS.ZFIRSTINCOMINGSENDERDATE + 978307200, 'unixepoch') AS "FIRST INCOMING SENDER DATE",
	DATETIME(ZCONTACTS.ZFIRSTOUTGOINGRECIPIENTDATE + 978307200, 'unixepoch') AS "FIRST OUTGOING RECIPIENT DATE",
	DATETIME(ZCONTACTS.ZLASTINCOMINGSENDERDATE + 978307200, 'unixepoch') AS "LAST INCOMING SENDER DATE",
	CASE
	ZLASTINCOMINGRECIPIENTDATE
	WHEN
	"0"
	THEN
	"0"
	ELSE
	DATETIME(ZCONTACTS.ZLASTINCOMINGRECIPIENTDATE + 978307200, 'unixepoch')
	END AS "LAST INCOMING RECIPIENT DATE",
	DATETIME(ZCONTACTS.ZLASTOUTGOINGRECIPIENTDATE + 978307200, 'unixepoch') AS "LAST OUTGOING RECIPIENT DATE",
	ZINTERACTIONS.ZACCOUNT,
	ZINTERACTIONS.ZDOMAINIDENTIFIER,
	ZCONTACTS.ZINCOMINGRECIPIENTCOUNT,
	ZCONTACTS.ZINCOMINGSENDERCOUNT,
	ZCONTACTS.ZOUTGOINGRECIPIENTCOUNT,
	ZCONTACTS.ZCUSTOMIDENTIFIER,
	ZINTERACTIONS.ZCONTENTURL,
	ZINTERACTIONS.ZLOCATIONUUID,
	ZINTERACTIONS.Z_PK AS "ZINTERACTIONS TABLE ID"
	FROM
	ZINTERACTIONS
	LEFT JOIN
	ZCONTACTS
	ON ZINTERACTIONS.ZSENDER = ZCONTACTS.Z_PK

[FileParser.ios.knowledge_app_activity]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_app_activity.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "BUNDLE ID",
	ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__ACTIVITYTYPE AS "ACTIVITY TYPE",
	ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__TITLE AS "TITLE",
	DATETIME(ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__EXPIRATIONDATE + 978307200, 'UNIXEPOCH') AS "EXPIRATION DATE",
	ZSTRUCTUREDMETADATA.Z_DKAPPLICATIONACTIVITYMETADATAKEY__ITEMRELATEDCONTENTURL AS "CONTENT URL",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE + 978307200, 'UNIXEPOCH') AS "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME IS "/app/activity"

[FileParser.ios.powerlog_device_lock_state]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_lock_state.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Records when the device is locked or unlocked.
query = 
	SELECT
	DATETIME(LOCKSTATE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	CASE LOCKED
	WHEN "0" THEN "DEVICE UNLOCKED"
	WHEN "1" THEN "DEVICE LOCKED"
	END AS "LOCK STATUS",
	DATETIME(LOCKSTATE_TIMESTAMP, 'unixepoch') AS ORIGINAL_LOCKSTATE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	LOCKSTATE_ID AS "PLSPRINGBOARDAGENT_EVENTFORWARD_SBLOCK TABLE ID"
	FROM
	(
	SELECT
	LOCKSTATE_ID,
	LOCKSTATE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	LOCKED,
	SYSTEM
	FROM
	(
	SELECT
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBLOCK.TIMESTAMP AS LOCKSTATE_TIMESTAMP,
	LOCKED,
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBLOCK.ID AS "LOCKSTATE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBLOCK
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS LOCKSTATE_STATE
	GROUP BY
	LOCKSTATE_ID
	)

[FileParser.ios.powerlog_location_client_status]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_location_client_status.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Location Usage by App/Process Client
query = 
	SELECT
	DATETIME(LOCATIONAGENT_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	DATETIME(TIMESTAMPLOGGED+ SYSTEM, 'unixepoch') AS "TIMESTAMP LOGGED (ADJ)",
	DATETIME(TIMESTAMPEND + SYSTEM, 'unixepoch') AS "TIMESTAMP END (ADJ)",
	BUNDLEID AS "BUNDLE ID",
	TYPE AS "TYPE",
	LOCATIONDESIREDACCURACY AS "LOCATION DESIRED ACCURACY",
	LOCATIONDISTANCEFILTER AS "LOCATION DISTANCE FILTER",
	CLIENT AS "CLIENT",
	EXECUTABLE AS "EXECUTABLE",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	LOCATIONAGENT_ID AS "PLLOCATIONAGENT_EVENTFORWARD_CLIENTSTATUS TABLE ID"
	FROM
	(
	SELECT
	LOCATIONAGENT_ID,
	LOCATIONAGENT_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	TIMESTAMPEND,
	TIMESTAMPLOGGED,
	BUNDLEID,
	TYPE,
	LOCATIONDESIREDACCURACY,
	LOCATIONDISTANCEFILTER,
	CLIENT,
	EXECUTABLE,
	SYSTEM
	FROM
	(
	SELECT
	PLLOCATIONAGENT_EVENTFORWARD_CLIENTSTATUS.TIMESTAMP AS LOCATIONAGENT_TIMESTAMP,
	TIMESTAMPEND,
	TIMESTAMPLOGGED,
	BUNDLEID,
	TYPE,
	LOCATIONDESIREDACCURACY,
	LOCATIONDISTANCEFILTER,
	CLIENT,
	EXECUTABLE,
	PLLOCATIONAGENT_EVENTFORWARD_CLIENTSTATUS.ID AS "LOCATIONAGENT_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLLOCATIONAGENT_EVENTFORWARD_CLIENTSTATUS
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS LOCATIONAGENT_STATE
	GROUP BY
	LOCATIONAGENT_ID
	)

[FileParser.ios.powerlog_camera_state]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_camera_state.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Records when and which camera is in use.
query = 
	SELECT
	DATETIME(CAMERA_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BUNDLEID AS BUNDLE_ID,
	CASE STATE
	WHEN "0" THEN "OFF"
	WHEN "1" THEN "ON"
	END AS STATE,
	CASE CAMERA_TYPE
	WHEN "2" THEN "FRONT"
	WHEN "0" THEN "BACK"
	END AS CAMERA_TYPE,
	DATETIME(CAMERA_TIMESTAMP, 'unixepoch') AS ORIGINAL_CAMERA_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	CAMERA_ID AS "PLCAMERAAGENT_EVENTFORWARD_CAMERA TABLE ID"
	FROM
	(
	SELECT
	BUNDLEID,
	CAMERA_ID,
	CAMERA_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) as max_id,
	SYSTEM,
	CAMERA_TYPE,
	STATE
	FROM
	(
	SELECT
	PLCAMERAAGENT_EVENTFORWARD_CAMERA.TIMESTAMP AS CAMERA_TIMESTAMP,
	PLCAMERAAGENT_EVENTFORWARD_CAMERA.BUNDLEID,
	PLCAMERAAGENT_EVENTFORWARD_CAMERA.CAMERATYPE AS "CAMERA_TYPE",
	PLCAMERAAGENT_EVENTFORWARD_CAMERA.STATE,
	PLCAMERAAGENT_EVENTFORWARD_CAMERA.ID as "CAMERA_ID",
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM,
	BUNDLEID
	FROM
	PLCAMERAAGENT_EVENTFORWARD_CAMERA
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS CAMERASTATE
	GROUP BY
	CAMERA_ID
	)

[FileParser.ios.powerlog_ids_messages]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_ids_messages.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	DATETIME(TIMESTAMPEND, 'unixepoch') AS "TIMESTAMP END",
	TOPIC AS "TOPIC",
	PRIORITY AS "PRIORITY",
	INCOMINGMESSAGES AS "INCOMING MESSAGES",
	OUTGOINGMESSAGES AS "OUTGOING MESSAGES",
	INCOMINGBYTES AS "INCOMING BYTES",
	OUTGOINGBYTES AS "OUTGOING BYTES",
	ID AS "PLIDENTITYSERVICESAGENT_EVENTINTERVAL_IDSMESSAGEPERIODIC TABLE ID"
	FROM
	PLIDENTITYSERVICESAGENT_EVENTINTERVAL_IDSMESSAGEPERIODIC

[FileParser.ios.passes23_wallet_transactions]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/passes23_wallet_transactions.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Wallet Transactions
query = 
	SELECT
	DATETIME(PAYMENT_TRANSACTION.TRANSACTION_DATE+978307200,'UNIXEPOCH') AS "TRANSACTION DATE",
	PASS.ORGANIZATION_NAME AS "ORGANIZATION NAME",
	PASS_TYPE.IDENTIFIER AS "IDENTIFIER",
	PAYMENT_TRANSACTION.AMOUNT/100.00 AS "AMOUNT",
	PAYMENT_TRANSACTION.CURRENCY_CODE AS "CURRENCY CODE",
	PAYMENT_TRANSACTION.MERCHANT_INDUSTRY_CATEGORY AS "MERCHANT INDUSTRY CATEGORY",
	PAYMENT_TRANSACTION.MERCHANT_NAME AS "MERCHANT NAME",
	DATETIME(PASS.INGESTED_DATE+978307200,'UNIXEPOCH') AS "INGESTED DATE",
	DATETIME(PASS.MODIFIED_DATE+978307200,'UNIXEPOCH') AS "MODIFIED DATE",
	PASS.UNIQUE_ID AS "PASS ID"
	FROM PASS
	LEFT JOIN PASS_TYPE ON PASS.PASS_TYPE_PID == PASS_TYPE.PID
	LEFT JOIN PAYMENT_TRANSACTION ON PASS.PID == PAYMENT_TRANSACTION.PASS_PID
	LEFT JOIN LOCATION_SOURCE ON LOCATION_SOURCE.URL LIKE '%'||PASS.UNIQUE_ID||'%'
	LEFT JOIN LOCATION ON LOCATION.LOCATION_SOURCE_PID == LOCATION_SOURCE.PID
	WHERE "AMOUNT" NOT NULL

[FileParser.ios.routined_local_vehicle_parked]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_vehicle_parked.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Parked Vehicle - Last Location
query = 
	SELECT
	DATETIME(ZRTVEHICLEEVENTMO.ZDATE + 978307200, 'unixepoch') AS "DATE",
	DATETIME(ZRTVEHICLEEVENTMO.ZLOCDATE + 978307200, 'unixepoch') AS "LOCATION DATE",
	ZLOCLATITUDE || ", " || ZLOCLONGITUDE AS "COORDINATES",
	ZVEHICLEIDENTIFIER AS "VEHICLE IDENTIFIER",
	ZLOCUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZIDENTIFIER AS "IDENTIFIER",
	ZLOCATIONQUALITY AS "LOCATION QUALITY",
	ZUSERSETLOCATION AS "USER SET LOCATION",
	ZUSUALLOCATION AS "USUAL LOCATION",
	ZNOTES AS "NOTES",
	ZGEOMAPITEM AS "GEO MAP ITEM",
	ZPHOTODATA AS "PHOTO DATA",
	ZLOCLATITUDE AS "LATITUDE",
	ZLOCLONGITUDE AS "LONGITUDE",
	ZRTVEHICLEEVENTMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTVEHICLEEVENTMO

[FileParser.ios.knowledge_safari_browsing]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_safari_browsing.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Safari browsing stored in the knowledgeC.db database
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "URL",
	ZSOURCE.ZBUNDLEID AS "BUNDLE ID",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME IS "/safari/history"

[FileParser.ios.routined_local_learned_location_of_interest_transition_start]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_learned_location_of_interest_transition_start.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Location of Interest Transition Start (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "START",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "STOP",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "CREATION DATE",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "EXPIRATION",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE AS "LOI LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "LOI LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.Z_PK AS "ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO TABLE ID"
	FROM
	ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO
	LEFT JOIN
	ZRTLEARNEDLOCATIONOFINTERESTMO
	ON ZRTLEARNEDLOCATIONOFINTERESTMO.Z_PK = ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZLOCATIONOFINTEREST

[FileParser.ios.powerlog_device_screen]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_screen.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Records which Springboard screen device is on. Homescreen(s)=2 Widgets=19, Control Center=5, Lock Screen=9, Pin Unlock Screen=15, Blank Screen=0, App Switcher=4, Spotlight Search=18, Lock Screen Camera=11, Lock Screen Widgets=17
query = 
	SELECT
	DATETIME(SCREENSTATE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	SCREEN,
	DATETIME(SCREENSTATE_TIMESTAMP, 'unixepoch') AS ORIGINAL_SCREENSTATE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	SCREENSTATE_ID AS "PLSPRINGBOARDAGENT_EVENTFORWARD_SBSCREEN TABLE ID"
	FROM
	(
	SELECT
	SCREENSTATE_ID,
	SCREENSTATE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	SCREEN,
	SYSTEM
	FROM
	(
	SELECT
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBSCREEN.TIMESTAMP AS SCREENSTATE_TIMESTAMP,
	SCREEN,
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBSCREEN.ID AS "SCREENSTATE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLSPRINGBOARDAGENT_EVENTFORWARD_SBSCREEN
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS SCREENSTATE_STATE
	GROUP BY
	SCREENSTATE_ID
	)

[FileParser.ios.knowledge_audio_output_route]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_audio_output_route.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Audio Output
query = 
	SELECT
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__IDENTIFIER AS "AUDIO IDENTIFIER",
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__PORTNAME AS "AUDIO PORT NAME",
	ZSTRUCTUREDMETADATA.Z_DKAUDIOMETADATAKEY__PORTTYPE AS "AUDIO PORT TYPE",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME = "/audio/outputRoute"

[FileParser.ios.knowledge_application_portrait]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_application_portrait.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Provides contest to application activities.
query = 
	SELECT
	ZSOURCE.ZBUNDLEID AS "BUNDLE ID",
	ZSOURCE.ZGROUPID AS "GROUP ID",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME IS "/portrait/entity" OR ZSTREAMNAME IS "/portrait/topic"

[FileParser.ios.routined_cloud_visit_outbound_start]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_outbound_start.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Outbound Start (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "OUTBOUND START DATE",
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "OUTBOUND STOP DATE",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
	LEFT JOIN
	ZRTLEARNEDTRANSITIONMO
	ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZOUTBOUND
	WHERE "OUTBOUND START DATE" NOT NULL

[FileParser.ios.powerlog_device_volume]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_volume.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Volume Percentage
query = 
	SELECT
	DATETIME(VOLUME_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	VOLUME AS "VOLUME PERCENTAGE",
	CASE MUTED
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END AS "MUTED",
	DATETIME(VOLUME_TIMESTAMP, 'unixepoch') AS ORIGINAL_VOLUME_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	VOLUME_ID AS "PLAUDIOAGENT_EVENTFORWARD_OUTPUT TABLE ID"
	FROM
	(
	SELECT
	VOLUME_ID,
	VOLUME_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	VOLUME,
	MUTED,
	SYSTEM
	FROM
	(
	SELECT
	PLAUDIOAGENT_EVENTFORWARD_OUTPUT.TIMESTAMP AS VOLUME_TIMESTAMP,
	VOLUME,
	MUTED,
	PLAUDIOAGENT_EVENTFORWARD_OUTPUT.ID AS "VOLUME_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLAUDIOAGENT_EVENTFORWARD_OUTPUT
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS VOLUME_STATE
	GROUP BY
	VOLUME_ID
	)

[FileParser.ios.health_workout_location_latitude]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_location_latitude.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Location Latitude
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.NUMERICAL_VALUE AS "LATITUDE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "_HKPrivateWorkoutWeatherLocationCoordinatesLatitude"

[FileParser.ios.locationd_cacheencryptedAB_celllocationlocal]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_celllocationlocal.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Cell Location Local
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	MNC AS "MNC",
	LAC AS "LAC",
	CI AS "CI",
	UARFCN AS "UARFCN",
	PSC AS "PSC",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM CELLLOCATIONLOCAL

[FileParser.ios.routined_cache_zrtcllocationmo]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cache_zrtcllocationmo.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Granular Location Data (~1 Week)
query = 
	SELECT
	DATETIME(ZTIMESTAMP + 978307200, 'unixepoch') AS "TIMESTAMP",
	ZLATITUDE || ", " || ZLONGITUDE AS "COORDINATES",
	ZALTITUDE AS "ALTITUDE",
	ZCOURSE AS "COURSE",
	ZSPEED AS "SPEED (M/S)",
	ZHORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	ZVERTICALACCURACY AS "VERTICAL ACCURACY",
	ZLATITUDE AS "LATITUDE",
	ZLONGITUDE AS "LONGITUDE",
	ZRTCLLOCATIONMO.Z_PK AS "ZRTCLLOCATIONMO TABLE ID"
	FROM
	ZRTCLLOCATIONMO

[FileParser.ios.knowledge_app_intents]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_app_intents.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Application intents, provides application context.
query = 
	SELECT
	ZSOURCE.ZBUNDLEID AS "BUNDLE ID",
	ZOBJECT.ZVALUESTRING AS "APP NAME",
	ZSTRUCTUREDMETADATA.Z_DKINTENTMETADATAKEY__INTENTCLASS AS "INTENT CLASS",
	ZSTRUCTUREDMETADATA.Z_DKINTENTMETADATAKEY__INTENTVERB AS "INTENT VERB",
	(ZOBJECT.ZENDDATE-ZOBJECT.ZSTARTDATE) as "USAGE IN SECONDS",
	HEX(ZSTRUCTUREDMETADATA.Z_DKINTENTMETADATAKEY__SERIALIZEDINTERACTION) AS "SERIALIZED INTERACTION (HEX)",
	ZSOURCE.ZGROUPID AS "GROUP ID",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME IS "/app/intents"

[FileParser.ios.locationd_cacheencryptedAB_cdmacelllocation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_cdmacelllocation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd CDMA Cell Location
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	SID AS "SID",
	NID AS "NID",
	BSID AS "BSID",
	ZONEID AS "ZONEID",
	BANDCLASS AS "BANDCLASS",
	CHANNEL AS "CHANNEL",
	PNOFFSET AS "PNOFFSET",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM CdmaCellLocation

[FileParser.ios.locationd_cacheencryptedC_motionstatehistory]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedC_motionstatehistory.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Motion State History
query = 
	SELECT
	DATETIME(STARTTIME + 978307200, 'unixepoch') AS "START TIME",
	TIMESTAMP AS "TIMESTAMP",
	TYPE AS "TYPE",
	CONFIDENCE AS "CONFIDENCE",
	MOUNTED AS "MOUNTED",
	MOUNTEDCONFIDENCE AS "MOUNTED CONFIDENCE",
	TURN AS "TURN",
	ISVEHICULAR AS "IS VEHICULAR",
	ISMOVING AS "IS MOVING",
	VEHICLEEXITSTATE AS "VEHICLE EXIT STATE",
	VEHICULARFLAGSDATA AS "VEHICULAR FLAGS DATA",
	MOTIONSTATEHISTORY.ID AS "MOTIONSTATEHISTORY TABLE ID"
	FROM MOTIONSTATEHISTORY

[FileParser.ios.health_stood_up]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_stood_up.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Stood Up
query = 
	SELECT
	QUANTITY AS "STOOD UP",
	DATETIME(SAMPLES.START_DATE + 978307200, 'unixepoch') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'unixepoch') AS "END DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	QUANTITY_SAMPLES
	ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	WHERE
	SAMPLES.DATA_TYPE = 75

[FileParser.ios.powerlog_app_usage_by_hour]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_usage_by_hour.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(APPUSAGE_TIMESTAMP + SYSTEM, 'unixepoch') AS "HOUR OF DAY",
	TIMEINTERVAL / 60 AS "TIME INTERVAL (MINUTES)",
	BUNDLEID AS "BUNDLE ID",
	SCREENONTIME AS "SCREEN TIME (SECONDS)",
	BACKGROUNDTIME AS "BACKGROUND TIME (SECONDS)",
	BACKGROUNDAUDIONOWPLAYINGTIME AS "BACKGROUND AUDIO NOW PLAYING TIME (SECONDS)",
	BACKGROUNDLOCATIONTIME AS "BACKGROUND LOCATION TIME (SECONDS)",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	APPUSAGE_ID AS "PLAPPTIMESERVICE_AGGREGATE_APPRUNTIME TABLE ID"
	FROM
	(
	SELECT
	APPUSAGE_ID,
	APPUSAGE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	TIMEINTERVAL,
	BUNDLEID,
	SCREENONTIME,
	BACKGROUNDTIME,
	BACKGROUNDAUDIONOWPLAYINGTIME,
	BACKGROUNDLOCATIONTIME,
	SYSTEM
	FROM
	(
	SELECT
	PLAPPTIMESERVICE_AGGREGATE_APPRUNTIME.TIMESTAMP AS APPUSAGE_TIMESTAMP,
	TIMEINTERVAL,
	BUNDLEID,
	SCREENONTIME,
	BACKGROUNDTIME,
	BACKGROUNDAUDIONOWPLAYINGTIME,
	BACKGROUNDLOCATIONTIME,
	PLAPPTIMESERVICE_AGGREGATE_APPRUNTIME.ID AS "APPUSAGE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLAPPTIMESERVICE_AGGREGATE_APPRUNTIME
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS APPUSAGE_STATE
	GROUP BY
	APPUSAGE_ID
	)

[FileParser.ios.health_workout_weather]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_weather.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Weather
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	CASE METADATA_VALUES.NUMERICAL_VALUE
	WHEN 1.0 THEN "SUNNY"
	WHEN 2.0 THEN "SUNNY OR INDOOR"
	WHEN 3.0 THEN "PARTLY CLOUDY"
	WHEN 4.0 THEN "CLOUDY"
	WHEN 5.0 THEN "CLOUDY"
	WHEN 6.0 THEN "FOG"
	WHEN 18.0 THEN "SNOW"
	WHEN 31.0 THEN "RAIN"
	WHEN 35.0 THEN "THUNDERSTORM"
	ELSE "UNKNOWN"  || "-" || METADATA_VALUES.NUMERICAL_VALUE
	END "WEATHER",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "_HKPrivateWeatherCondition"

[FileParser.ios.locationd_cacheencryptedC_nataliehistory]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedC_nataliehistory.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Natalie History
query = 
	SELECT
	DATETIME(STARTTIME + 978307200, 'UNIXEPOCH') AS "START TIME",
	ACTIVITYTYPE AS "ACTIVITY TYPE",
	ISSTANDING AS "IS STANDING",
	METS AS "METS",
	NATALIES AS "NATALIES",
	BASALNATALIES AS "BASEL NATALIES",
	OVERRIDESET AS "OVERRIDE SET",
	TRUTHMETS AS "TRUTH METS",
	NATALIEHISTORY.ID AS "NATALIEHISTORY TABLE ID"
	FROM NATALIEHISTORY

[FileParser.ios.routined_cloud_visit_inbound_stop]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_inbound_stop.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Inbound Stop (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "INBOUND START DATE",
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "INBOUND STOP DATE",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
	LEFT JOIN
	ZRTLEARNEDTRANSITIONMO
	ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZINBOUND
	WHERE "INBOUND START DATE" NOT NULL

[FileParser.ios.powerlog_torch_state]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_torch_state.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Determine when the flashlight/torch was turned on/off and how (com.apple.springboard in the Bundle ID is using the control center).
query = 
	SELECT
	DATETIME(TORCH_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	BUNDLEID AS BUNDLE_ID,
	CASE LEVEL
	WHEN "0" THEN "OFF"
	WHEN "1" THEN "ON"
	END AS STATUS,
	DATETIME(TORCH_TIMESTAMP, 'unixepoch') AS ORIGINAL_TORCH_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	TORCH_ID
	FROM
	(
	SELECT
	BUNDLEID,
	TORCH_ID,
	TORCH_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	SYSTEM,
	LEVEL
	FROM
	(
	SELECT
	PLCAMERAAGENT_EVENTFORWARD_TORCH.TIMESTAMP AS TORCH_TIMESTAMP,
	PLCAMERAAGENT_EVENTFORWARD_TORCH.BUNDLEID,
	PLCAMERAAGENT_EVENTFORWARD_TORCH.LEVEL,
	PLCAMERAAGENT_EVENTFORWARD_TORCH.ID as "TORCH_ID",
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM,
	BUNDLEID
	FROM
	PLCAMERAAGENT_EVENTFORWARD_TORCH
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS TORCHESTATE
	GROUP BY
	TORCH_ID
	)

[FileParser.ios.health_workout_timezone]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_timezone.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Workout Time Zone
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.STRING_VALUE AS "TIME ZONE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "HKTimeZone"

[FileParser.ios.datausage_zliveusage]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/datausage_zliveusage.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Data Usage Traffic by Process.
query = 
	SELECT
	DATETIME(ZLIVEUSAGE.ZTIMESTAMP + 978307200, 'unixepoch') AS "TIMESTAMP",
	DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
	DATETIME(ZPROCESS.ZTIMESTAMP+ 978307200, 'unixepoch') AS "PROCESS TIMESTAMP",
	ZPROCESS.ZPROCNAME AS "PROCESS NAME",
	ZPROCESS.ZBUNDLENAME AS "BUNDLE ID",
	ZLIVEUSAGE.ZWIFIIN AS "WIFI IN",
	ZLIVEUSAGE.ZWIFIOUT AS "WIFI OUT",
	ZLIVEUSAGE.ZWWANIN AS "WWAN IN",
	ZLIVEUSAGE.ZWWANOUT AS "WWAN OUT",
	ZLIVEUSAGE.Z_PK AS "ZLIVEUSAGE TABLE ID"
	FROM ZLIVEUSAGE
	LEFT JOIN ZPROCESS ON ZLIVEUSAGE.ZHASPROCESS = ZPROCESS.Z_PK

[FileParser.ios.locationd_cacheencryptedAB_ltecelllocationlocal]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_ltecelllocationlocal.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd LTE Cell Location Local
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	MNC AS "MNC",
	CI AS "CI",
	UARFCN AS "UARFCN",
	PID as "PID",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM LteCellLocationLocal

[FileParser.ios.health_steps]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_steps.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Steps
query = 
	SELECT
	QUANTITY AS "STEPS",
	DATETIME(SAMPLES.START_DATE + 978307200, 'unixepoch') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'unixepoch') AS "END DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	QUANTITY_SAMPLES
	ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	WHERE
	SAMPLES.DATA_TYPE = 7

[FileParser.ios.powerlog_push_message_received]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_push_message_received.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	BUNDLEID AS "BUNDLE ID",
	CONNECTIONTYPE AS "CONNECTION TYPE",
	ISDROPPED AS "IS DROPPED",
	LINKQUALITY AS "LINK QUALITY",
	PRIORITY,
	TOPIC,
	SERVERHOSTNAME AS "SERVER HOSTNAME",
	SERVERIP AS "SERVER IP",
	ID AS "PLPUSHAGENT_EVENTPOINT_RECEIVEDPUSH TABLE ID"
	FROM
	PLPUSHAGENT_EVENTPOINT_RECEIVEDPUSH

[FileParser.ios.powerlog_lightnining_connector_status]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_lightnining_connector_status.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Lightning Connector Status/Power Mode
query = 
	SELECT
	DATETIME(LIGHTNINGCONNECTOR_TIMESTAMP + SYSTEM, 'unixepoch','localtime') AS ADJUSTED_TIMESTAMP,
	CASE IOACCESSORYPOWERMODE
	WHEN "1" THEN "UNPLUGGED"
	WHEN "3" THEN "PLUGGED IN"
	END  AS "IO ACCESSORY POWER MODE",
	DATETIME(LIGHTNINGCONNECTOR_TIMESTAMP, 'unixepoch') AS ORIGINAL_LIGHTNINGCONNECTOR_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	LIGHTNINGCONNECTOR_ID AS "PLBATTERYAGENT_EVENTFORWARD_LIGHTNINGCONNECTORSTATUS TABLE ID"
	FROM
	(
	SELECT
	LIGHTNINGCONNECTOR_ID,
	LIGHTNINGCONNECTOR_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	IOACCESSORYPOWERMODE,
	SYSTEM
	FROM
	(
	SELECT
	PLBATTERYAGENT_EVENTFORWARD_LIGHTNINGCONNECTORSTATUS.TIMESTAMP AS LIGHTNINGCONNECTOR_TIMESTAMP,
	IOACCESSORYPOWERMODE,
	PLBATTERYAGENT_EVENTFORWARD_LIGHTNINGCONNECTORSTATUS.ID AS "LIGHTNINGCONNECTOR_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLBATTERYAGENT_EVENTFORWARD_LIGHTNINGCONNECTORSTATUS
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS LIGHTNINGCONNECTOR_STATE
	GROUP BY
	LIGHTNINGCONNECTOR_ID
	)

[FileParser.ios.health_workout_timeofday]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_timeofday.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Time of Day
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	CASE METADATA_VALUES.NUMERICAL_VALUE
	WHEN 0.0 THEN "NIGHT"
	WHEN 1.0 THEN "DAY"
	END "TIME OF DAY",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "_HKPrivateWorkoutWasInDaytime"

[FileParser.ios.knowledge_device_orientation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_orientation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = The screen orientation of the iOS device, portrait or landscape.
query = 
	SELECT
	CASE
	ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'PORTRAIT'
	WHEN '1' THEN 'LANDSCAPE'
	END "ORIENTATION",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME is "/display/orientation"

[FileParser.ios.health_distance]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_distance.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Distance
query = 
	SELECT
	QUANTITY AS "DISTANCE IN METERS",
	DATETIME(SAMPLES.START_DATE + 978307200, 'unixepoch') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'unixepoch') AS "END DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	QUANTITY_SAMPLES
	ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	LEFT OUTER JOIN
	CORRELATIONS
	ON SAMPLES.DATA_ID = CORRELATIONS.OBJECT
	WHERE
	SAMPLES.DATA_TYPE = 8

[FileParser.ios.sms_chat]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/sms_chat.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = SMS and Chat Messages
query = 
	SELECT
	CASE
	WHEN LENGTH(MESSAGE.DATE)=18 THEN DATETIME(MESSAGE.DATE/1000000000+978307200,'UNIXEPOCH')
	WHEN LENGTH(MESSAGE.DATE)=9 THEN DATETIME(MESSAGE.DATE + 978307200,'UNIXEPOCH')
	ELSE "N/A"
	END "MESSAGE DATE",
	CASE
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=18 THEN DATETIME(MESSAGE.DATE_DELIVERED/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=9 THEN DATETIME(MESSAGE.DATE_DELIVERED+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE DELIVERED",
	CASE
	WHEN LENGTH(MESSAGE.DATE_READ)=18 THEN DATETIME(MESSAGE.DATE_READ/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_READ)=9 THEN DATETIME(MESSAGE.DATE_READ+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE READ",
	MESSAGE.TEXT as "MESSAGE",
	HANDLE.ID AS "CONTACT ID",
	MESSAGE.SERVICE AS "SERVICE",
	MESSAGE.ACCOUNT AS "ACCOUNT",
	MESSAGE.IS_DELIVERED AS "IS DELIVERED",
	MESSAGE.IS_FROM_ME AS "IS FROM ME",
	ATTACHMENT.FILENAME AS "FILENAME",
	ATTACHMENT.MIME_TYPE AS "MIME TYPE",
	ATTACHMENT.TRANSFER_NAME AS "TRANSFER TYPE",
	ATTACHMENT.TOTAL_BYTES AS "TOTAL BYTES"
	FROM MESSAGE
	LEFT OUTER JOIN MESSAGE_ATTACHMENT_JOIN ON MESSAGE.ROWID = MESSAGE_ATTACHMENT_JOIN.MESSAGE_ID
	LEFT OUTER JOIN ATTACHMENT ON MESSAGE_ATTACHMENT_JOIN.ATTACHMENT_ID = ATTACHMENT.ROWID
	LEFT OUTER JOIN HANDLE ON MESSAGE.HANDLE_ID = HANDLE.ROWID

[FileParser.ios.powerlog_device_screen_autolock]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_device_screen_autolock.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Records the Auto-Lock timestamp.
query = 
	SELECT
	DATETIME(SBAUTOLOCK_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	AUTOLOCKTYPE AS "AUTO LOCK TYPE",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	SBAUTOLOCK_ID AS "PLSPRINGBOARDAGENT_EVENTPOINT_SBAUTOLOCK TABLE ID"
	FROM
	(
	SELECT
	SBAUTOLOCK_ID,
	SBAUTOLOCK_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	AUTOLOCKTYPE,
	SYSTEM
	FROM
	(
	SELECT
	PLSPRINGBOARDAGENT_EVENTPOINT_SBAUTOLOCK.TIMESTAMP AS SBAUTOLOCK_TIMESTAMP,
	AUTOLOCKTYPE,
	PLSPRINGBOARDAGENT_EVENTPOINT_SBAUTOLOCK.ID AS "SBAUTOLOCK_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLSPRINGBOARDAGENT_EVENTPOINT_SBAUTOLOCK
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS SBAUTOLOCK_STATE
	GROUP BY
	SBAUTOLOCK_ID
	)

[FileParser.ios.powerlog_airdrop]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_airdrop.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Airdrop Connection infomation
query = 
	SELECT
	DATETIME(AIRDROP_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	STATE,
	SUBEVENT,
	BUNDLEID AS BUNDLE_ID,
	PID,
	DATETIME(AIRDROP_TIMESTAMP, 'unixepoch') AS ORIGINAL_AIRDROP_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	AIRDROP_ID AS "PLXPCAGENT_EVENTFORWARD_AIRDROP TABLE ID"
	FROM
	(
	SELECT
	BUNDLEID,
	AIRDROP_ID,
	AIRDROP_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) as max_id,
	SYSTEM,
	PID,
	SUBEVENT,
	STATE
	FROM
	(
	SELECT
	PLXPCAGENT_EVENTFORWARD_AIRDROP.TIMESTAMP AS AIRDROP_TIMESTAMP,
	PLXPCAGENT_EVENTFORWARD_AIRDROP.BUNDLEID,
	PLXPCAGENT_EVENTFORWARD_AIRDROP.PID,
	PLXPCAGENT_EVENTFORWARD_AIRDROP.SUBEVENT,
	PLXPCAGENT_EVENTFORWARD_AIRDROP.STATE,
	PLXPCAGENT_EVENTFORWARD_AIRDROP.ID as "AIRDROP_ID",
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM,
	BUNDLEID
	FROM
	PLXPCAGENT_EVENTFORWARD_AIRDROP
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS AIRDROPSTATE
	GROUP BY
	AIRDROP_ID
	)

[FileParser.ios.powerlog_battery_level_ui]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_battery_level_ui.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	LEVEL,
	ID AS "PLBATTERYAGENT_EVENTBACKWARD_BATTERYUI TABLE ID"
	FROM
	PLBATTERYAGENT_EVENTBACKWARD_BATTERYUI

[FileParser.ios.netusage_zliverouteperf]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/netusage_zliverouteperf.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Network Usage Traffic by Network.
query = 
	SELECT
	DATETIME(ZLIVEROUTEPERF.ZTIMESTAMP + 978307200, 'unixepoch') AS "LIVEROUTEPREF TIMESTAMP",
	DATETIME(ZNETWORKATTACHMENT.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "FIRST NETWORK ATTACHMENT",
	DATETIME(ZNETWORKATTACHMENT.ZTIMESTAMP + 978307200, 'unixepoch') AS "NETWORK ATTACHMENT TIMESTAMP",
	CASE ZLIVEROUTEPERF.ZKIND
	WHEN 1 THEN "WIFI"
	WHEN 2 THEN "CELLULAR"
	END "NETWORK TYPE",
	ZLIVEROUTEPERF.ZBYTESIN AS "BYTES IN",
	ZLIVEROUTEPERF.ZBYTESOUT AS "BYTES OUT",
	ZLIVEROUTEPERF.ZPACKETSIN AS "PACKETS IN",
	ZLIVEROUTEPERF.ZPACKETSOUT AS "PACKETS OUT",
	ZLIVEROUTEPERF.ZCONNATTEMPTS AS "CONNECTION ATTEMPTS",
	ZLIVEROUTEPERF.ZCONNSUCCESSES AS "CONNECTION SUCCESSES",
	ZNETWORKATTACHMENT.ZIDENTIFIER AS "NETWORK IDENTIFIER",
	ZNETWORKATTACHMENT.ZISKNOWNGOOD AS "IS KNOWN GOOD",
	HEX(ZNETWORKATTACHMENT.ZNETSIGNATURE) AS "NET SIGNATURE (HEX)",
	ZNETWORKATTACHMENT.ZOVERALLSTAYMEAN AS "OVERALL STAY MEAN (NETWORK ATTACHMENT)",
	ZNETWORKATTACHMENT.ZOVERALLSTAYVAR AS "OVERALL STAY VAR (NETWORK ATTACHMENT)",
	ZLIVEROUTEPERF.ZOVERALLSTAY AS "OVERALL STAY MEAN (LIVE ROUTE PERF)",
	ZLIVEROUTEPERF.ZOVERALLSTAYM2 AS "OVERALL STAY M2 (LIVE ROUTE PERF)",
	ZLIVEROUTEPERF.Z_PK AS "ZLIVEROUTEPERF TABLE ID"
	FROM ZLIVEROUTEPERF
	LEFT JOIN ZNETWORKATTACHMENT ON ZLIVEROUTEPERF.ZHASNETWORKATTACHMENT = ZNETWORKATTACHMENT.Z_PK

[FileParser.ios.health_weight]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_weight.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Weight
query = 
	SELECT
	QUANTITY AS "WEIGHT (IN KG)",
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "DATE",
	SAMPLES.DATA_ID AS "SAMPLES TABLE ID"
	FROM
	SAMPLES
	LEFT OUTER JOIN QUANTITY_SAMPLES ON SAMPLES.DATA_ID = QUANTITY_SAMPLES.DATA_ID
	WHERE
	SAMPLES.DATA_TYPE = 3
	AND "DATE" IS  NOT NULL

[FileParser.ios.knowledge_audio_media_nowplaying]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_audio_media_nowplaying.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = What is currently playing in various audio apps.
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "BUNDLE ID",
	ZSTRUCTUREDMETADATA.Z_DKNOWPLAYINGMETADATAKEY__ALBUM AS "NOW PLAYING ALBUM",
	ZSTRUCTUREDMETADATA.Z_DKNOWPLAYINGMETADATAKEY__ARTIST AS "NOW PLAYING ARTIST",
	ZSTRUCTUREDMETADATA.Z_DKNOWPLAYINGMETADATAKEY__GENRE AS "NOW PLAYING GENRE",
	ZSTRUCTUREDMETADATA.Z_DKNOWPLAYINGMETADATAKEY__TITLE AS "NOW PLAYING TITLE",
	ZSTRUCTUREDMETADATA.Z_DKNOWPLAYINGMETADATAKEY__DURATION AS "NOW PLAYING DURATION",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME = "/media/nowPlaying"

[FileParser.ios.netusage_zprocess]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/netusage_zprocess.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Network Usage Processes/Bundle IDs
query = 
	SELECT
	DATETIME(ZPROCESS.ZTIMESTAMP+ 978307200, 'unixepoch') AS "TIMESTAMP",
	DATETIME(ZPROCESS.ZFIRSTTIMESTAMP + 978307200, 'unixepoch') AS "PROCESS FIRST TIMESTAMP",
	ZPROCESS.ZPROCNAME AS "PROCESS NAME",
	ZPROCESS.ZBUNDLENAME AS "BUNDLE ID",
	ZPROCESS.Z_PK AS "ZPROCESS TABLE ID"
	FROM ZPROCESS

[FileParser.ios.powerlog_wallet_card]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_wallet_card.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Wallet Authorized Status
query = 
	SELECT
	DATETIME(WALLETCARD_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	AUTHORIZEDSTATUS AS "AUTHORIZED STATUS",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	WALLETCARD_ID AS "PLNFCAGENT_EVENTFORWARD_CARD TABLE ID"
	FROM
	(
	SELECT
	WALLETCARD_ID,
	WALLETCARD_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	AUTHORIZEDSTATUS,
	SYSTEM
	FROM
	(
	SELECT
	PLNFCAGENT_EVENTFORWARD_CARD.TIMESTAMP AS WALLETCARD_TIMESTAMP,
	AUTHORIZEDSTATUS,
	PLNFCAGENT_EVENTFORWARD_CARD.ID AS "WALLETCARD_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLNFCAGENT_EVENTFORWARD_CARD
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS WALLETCARD_STATE
	GROUP BY
	WALLETCARD_ID
	)

[FileParser.ios.health_workout_location_longitude]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_location_longitude.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Location Longitude
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.NUMERICAL_VALUE AS "LONGITUDE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "_HKPrivateWorkoutWeatherLocationCoordinatesLongitude"

[FileParser.ios.routined_cloud_visit_inbound_start]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_inbound_start.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Inbound Start (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "INBOUND START DATE",
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "INBOUND STOP DATE",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
	LEFT JOIN
	ZRTLEARNEDTRANSITIONMO
	ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZINBOUND
	WHERE "INBOUND STOP DATE" NOT NULL

[FileParser.ios.knowledge_device_carplay_connected]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_carplay_connected.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Carplay Connections
query = 
	SELECT
	CASE
	ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'CONNECTED'
	WHEN '1' THEN 'DISCONNECTED'
	END "CARPLAY CONNECTED",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME is "/carplay/isConnected"

[FileParser.ios.knowledge_device_pluggedin]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_pluggedin.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Is the device is plugged in or not.
query = 
	SELECT
	CASE
	ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'UNPLUGGED'
	WHEN '1' THEN 'PLUGGED IN'
	END "IS PLUGGED IN",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME LIKE "/device/isPluggedIn"

[FileParser.ios.powerlog_bluetooth_device_state]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_bluetooth_device_state.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Keeps track of Bluetooth state on device, discoverability, connection, etc.
query = 
	SELECT
	DATETIME(BLUETOOTHSTATE_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	CASE DEVICECONNECTABLE
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END AS "DEVICE CONNECTABLE",
	CASE DEVICECONNECTED
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END AS "DEVICE CONNECTED",
	CASE DEVICEDISCOVERABLE
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END AS "DEVICE DISCOVERABLE",
	CASE DEVICEPOWERED
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END AS "DEVICE POWERED",
	DATETIME(BLUETOOTHSTATE_TIMESTAMP, 'unixepoch') AS ORIGINAL_BLUETOOTHSTATE_TIMESTAMP,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	BLUETOOTHSTATE_ID AS "PLBLUETOOTHAGENT_EVENTFORWARD_DEVICESTATE TABLE ID"
	FROM
	(
	SELECT
	BLUETOOTHSTATE_ID,
	BLUETOOTHSTATE_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	DEVICECONNECTABLE,
	DEVICECONNECTED,
	DEVICEDISCOVERABLE,
	DEVICEPOWERED,
	SYSTEM
	FROM
	(
	SELECT
	PLBLUETOOTHAGENT_EVENTFORWARD_DEVICESTATE.TIMESTAMP AS BLUETOOTHSTATE_TIMESTAMP,
	DEVICECONNECTABLE,
	DEVICECONNECTED,
	DEVICEDISCOVERABLE,
	DEVICEPOWERED,
	PLBLUETOOTHAGENT_EVENTFORWARD_DEVICESTATE.ID AS "BLUETOOTHSTATE_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLBLUETOOTHAGENT_EVENTFORWARD_DEVICESTATE
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS BLUETOOTHSTATE_STATE
	GROUP BY
	BLUETOOTHSTATE_ID
	)

[FileParser.ios.passes23_wallet_passes]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/passes23_wallet_passes.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Wallet Passes
query = 
	SELECT
	DATETIME(PASS.INGESTED_DATE+978307200,'UNIXEPOCH') AS "INGESTED DATE",
	DATETIME(PASS.MODIFIED_DATE+978307200,'UNIXEPOCH') AS "MODIFIED DATE",
	DATETIME(PASS.RELEVANT_DATE+978307200,'UNIXEPOCH') AS "RELEVANT TIME",
	PASS.ORGANIZATION_NAME AS "ORGANIZATION NAME",
	PASS_TYPE.IDENTIFIER AS "IDENTIFIER",
	LOCATION.RELEVANT_TEXT AS "RELEVANT TEXT",
	LOCATION.LATITUDE AS "LATITUDE",
	LOCATION.LONGITUDE AS "LONGITUDE",
	DATETIME(PASS.PUSH_REGISTRATION_DATE+978307200,'UNIXEPOCH') AS "PUSH REGISTRATION TIME",
	PASS.LAST_MODIFIED_TAG AS "LAST MODIFIED TAG",
	PASS.UNIQUE_ID AS "PASS ID"
	FROM PASS
	LEFT JOIN PASS_TYPE ON PASS.PASS_TYPE_PID == PASS_TYPE.PID
	LEFT JOIN PAYMENT_TRANSACTION ON PASS.PID == PAYMENT_TRANSACTION.PASS_PID
	LEFT JOIN LOCATION_SOURCE ON LOCATION_SOURCE.URL LIKE '%'||PASS.UNIQUE_ID||'%'
	LEFT JOIN LOCATION ON LOCATION.LOCATION_SOURCE_PID == LOCATION_SOURCE.PID
	WHERE AMOUNT IS NULL

[FileParser.ios.health_workout_general]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_general.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Workout, these workouts do not have additional metadata associated. This query does not produce all workouts, just those without metadata.
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL
	AND KEY IS NULL

[FileParser.ios.routined_cache_zrthintmo]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cache_zrthintmo.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Semi-granular Location Data (~1 Week)
query = 
	SELECT
	DATETIME(ZDATE + 978307200, 'unixepoch') AS "TIMESTAMP",
	ZLATITUDE || ", " || ZLONGITUDE AS "COORDINATES",
	ZSOURCE AS "SOURCE",
	ZLATITUDE AS "LATITUDE",
	ZLONGITUDE AS "LONGITUDE",
	ZRTHINTMO.Z_PK AS "ZRTHINTMO TABLE ID"
	FROM
	ZRTHINTMO

[FileParser.ios.health_workout_temperature]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_temperature.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Temperature
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.NUMERICAL_VALUE || " " ||METADATA_VALUES.STRING_VALUE AS "TEMPERATURE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "HKWeatherTemperature"

[FileParser.ios.query_predictions]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/query_predictions.csv"
	base.input.SQLiteReader
author = AlexisBrignoni/abrignoni.com/@alexisbrignoni
notes = Query_predictions.db
query = 
	select
	content,
	isSent,
	conversationId,
	id,
	uuid,
	datetime(creationTimestamp, "UNIXEPOCH", "LOCALTIME") as START
	from messages

[FileParser.ios.powerlog_wallet_transaction]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_wallet_transaction.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Wallet transaction status
query = 
	SELECT
	DATETIME(WALLETTRANSACTION_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	STATUS,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	WALLETTRANSACTION_ID AS "PLNFCAGENT_EVENTFORWARD_TRANSACTION TABLE ID"
	FROM
	(
	SELECT
	WALLETTRANSACTION_ID,
	WALLETTRANSACTION_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	STATUS,
	SYSTEM
	FROM
	(
	SELECT
	PLNFCAGENT_EVENTFORWARD_TRANSACTION.TIMESTAMP AS WALLETTRANSACTION_TIMESTAMP,
	STATUS,
	PLNFCAGENT_EVENTFORWARD_TRANSACTION.ID AS "WALLETTRANSACTION_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLNFCAGENT_EVENTFORWARD_TRANSACTION
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS WALLETTRANSACTION_STATE
	GROUP BY
	WALLETTRANSACTION_ID
	)

[FileParser.ios.powerlog_network_usage]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_network_usage.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	INTERFACE as "INTERFACE",
	DOWNBYTES AS "DOWN BYTES",
	UPBYTES AS "UP BYTES",
	ID AS "PLNETWORKAGENT_EVENTBACKWARD_CUMULATIVENETWORKUSAGE TABLE ID"
	FROM
	PLNETWORKAGENT_EVENTBACKWARD_CUMULATIVENETWORKUSAGE

[FileParser.ios.powerlog_location_tech_status]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_location_tech_status.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Technology used to determine location.
query = 
	SELECT
	DATETIME(LOCATIONTECH_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	ACCESSORY AS "ACCESSORY",
	CELL AS "CELL",
	GPS AS "GPS",
	GPS_COARSE AS "GPS COARSE",
	LAC AS "LAC",
	MCC AS "MCC",
	NMEA AS "NMEA",
	PIPELINE AS "PIPELINE",
	SKYHOOK AS "SKYHOOK",
	WIFI AS "WIFI",
	WIFI2 AS "WIFI2",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	LOCATIONTECH_ID AS "PLLOCATIONAGENT_EVENTFORWARD_TECHSTATUS TABLE ID"
	FROM
	(
	SELECT
	LOCATIONTECH_ID,
	LOCATIONTECH_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	ACCESSORY,
	CELL,
	GPS,
	GPS_COARSE,
	LAC,
	MCC,
	NMEA,
	PIPELINE,
	SKYHOOK,
	WIFI,
	WIFI2,
	SYSTEM
	FROM
	(
	SELECT
	PLLOCATIONAGENT_EVENTFORWARD_TECHSTATUS.TIMESTAMP AS LOCATIONTECH_TIMESTAMP,
	ACCESSORY,
	CELL,
	GPS,
	GPS_COARSE,
	LAC,
	MCC,
	NMEA,
	PIPELINE,
	SKYHOOK,
	WIFI,
	WIFI2,
	PLLOCATIONAGENT_EVENTFORWARD_TECHSTATUS.ID AS "LOCATIONTECH_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLLOCATIONAGENT_EVENTFORWARD_TECHSTATUS
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS LOCATIONTECH_STATE
	GROUP BY
	LOCATIONTECH_ID
	)

[FileParser.ios.routined_local_learned_location_of_interest_transition_stop]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_learned_location_of_interest_transition_stop.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Location of Interest Transition Stop (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "START",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "STOP",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "CREATION DATE",
	DATETIME(ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "EXPIRATION",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDLOCATIONOFINTERESTMO.ZPLACEMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLATITUDE AS "LOI LATITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTMO.ZLOCATIONLONGITUDE AS "LOI LONGITUDE",
	ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.Z_PK AS "ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO TABLE ID"
	FROM
	ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO
	LEFT JOIN
	ZRTLEARNEDLOCATIONOFINTERESTMO
	ON ZRTLEARNEDLOCATIONOFINTERESTMO.Z_PK = ZRTLEARNEDLOCATIONOFINTERESTTRANSITIONMO.ZLOCATIONOFINTEREST

[FileParser.ios.locationd_cacheencryptedAB_wifilocation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_wifilocation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Wi-Fi Location
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MAC as "Base10 MAC",
	CHANNEL AS "CHANNEL",
	INFOMASK AS "INFOMASK",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	SCORE AS "SCORE",
	REACH AS "REACH",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM WifiLocation

[FileParser.ios.health_workout_humidity]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_humidity.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Humidity
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	METADATA_VALUES.NUMERICAL_VALUE || METADATA_VALUES.STRING_VALUE AS "HUMIDITY",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "HKWeatherHumidity"

[FileParser.ios.knowledge_audio_bluetooth_connected]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_audio_bluetooth_connected.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Audio Bluetooth Connections
query = 
	SELECT
	ZSTRUCTUREDMETADATA.Z_DKBLUETOOTHMETADATAKEY__ADDRESS AS "BLUETOOTH ADDRESS",
	ZSTRUCTUREDMETADATA.Z_DKBLUETOOTHMETADATAKEY__NAME AS "BLUETOOTH NAME",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME = "/bluetooth/isConnected"

[FileParser.ios.powerlog_wifi_properties]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_wifi_properties.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Wi-Fi network connections
query = 
	SELECT
	DATETIME(WIFIPROPERTIES_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	CURRENTSSID,
	CURRENTCHANNEL,
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	WIFIPROPERTIES_ID AS "PLWIFIAGENT_EVENTBACKWARD_CUMULATIVEPROPERTIES TABLE ID"
	FROM
	(
	SELECT
	WIFIPROPERTIES_ID,
	WIFIPROPERTIES_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	CURRENTSSID,
	CURRENTCHANNEL,
	SYSTEM
	FROM
	(
	SELECT
	PLWIFIAGENT_EVENTBACKWARD_CUMULATIVEPROPERTIES.TIMESTAMP AS WIFIPROPERTIES_TIMESTAMP,
	CURRENTSSID,
	CURRENTCHANNEL,
	PLWIFIAGENT_EVENTBACKWARD_CUMULATIVEPROPERTIES.ID AS "WIFIPROPERTIES_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLWIFIAGENT_EVENTBACKWARD_CUMULATIVEPROPERTIES
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS WIFIPROPERTIES_STATE
	GROUP BY
	WIFIPROPERTIES_ID
	)

[FileParser.ios.knowledge_device_watch_nearby]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_device_watch_nearby.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Does the iPhone see the Apple Watch nearby.
query = 
	SELECT
	CASE
	ZOBJECT.ZVALUEINTEGER
	WHEN '0' THEN 'NO'
	WHEN '1' THEN 'YES'
	END "WATCH NEARBY",
	(ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS "USAGE IN SECONDS",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE
	ZSTREAMNAME is "/watch/nearby"

[FileParser.ios.knowledge_app_install]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/knowledge_app_install.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Installed applications
query = 
	SELECT
	ZOBJECT.ZVALUESTRING AS "BUNDLE ID",
	CASE ZOBJECT.ZSTARTDAYOFWEEK
	WHEN "1" THEN "Sunday"
	WHEN "2" THEN "Monday"
	WHEN "3" THEN "Tuesday"
	WHEN "4" THEN "Wednesday"
	WHEN "5" THEN "Thursday"
	WHEN "6" THEN "Friday"
	WHEN "7" THEN "Saturday"
	END "DAY OF WEEK",
	ZOBJECT.ZSECONDSFROMGMT/3600 AS "GMT OFFSET",
	DATETIME(ZOBJECT.ZSTARTDATE+978307200,'UNIXEPOCH') as "START",
	DATETIME(ZOBJECT.ZENDDATE+978307200,'UNIXEPOCH') as "END",
	DATETIME(ZOBJECT.ZCREATIONDATE+978307200,'UNIXEPOCH') as "ENTRY CREATION",
	ZOBJECT.Z_PK AS "ZOBJECT TABLE ID"
	FROM
	ZOBJECT
	LEFT JOIN
	ZSTRUCTUREDMETADATA
	ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
	LEFT JOIN
	ZSOURCE
	ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
	WHERE ZSTREAMNAME is "/app/install"

[FileParser.ios.powerlog_volume_level]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_volume_level.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = 
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	VOLUME,
	CASE MUTED
	WHEN "0" THEN "NO"
	WHEN "1" THEN "YES"
	END "MUTED",
	ID AS "PLAUDIOAGENT_EVENTFORWARD_OUTPUT TABLE ID"
	FROM
	PLAUDIOAGENT_EVENTFORWARD_OUTPUT

[FileParser.ios.routined_local_vehicle_parked_history]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_local_vehicle_parked_history.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Parked Vehicle - Historical Locations
query = 
	SELECT
	DATETIME(ZRTVEHICLEEVENTHISTORYMO.ZDATE + 978307200, 'unixepoch') AS "DATE",
	DATETIME(ZRTVEHICLEEVENTHISTORYMO.ZLOCDATE + 978307200, 'unixepoch') AS "LOCATION DATE",
	ZLOCLATITUDE || ", " || ZLOCLONGITUDE AS "COORDINATES",
	ZLOCUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZIDENTIFIER AS "IDENTIFIER",
	ZLOCLATITUDE AS "LATITUDE",
	ZLOCLONGITUDE AS "LONGITUDE",
	ZRTVEHICLEEVENTHISTORYMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTVEHICLEEVENTHISTORYMO

[FileParser.ios.health_workout_indoor]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/health_workout_indoor.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Health Indoor Workout
query = 
	SELECT
	DATETIME(SAMPLES.START_DATE + 978307200, 'UNIXEPOCH') AS "START DATE",
	DATETIME(SAMPLES.END_DATE + 978307200, 'UNIXEPOCH') AS "END DATE",
	CASE WORKOUTS.ACTIVITY_TYPE
	WHEN 63 THEN "HIGH INTENSITY INTERVAL TRAINING (HIIT)"
	WHEN 37 THEN "INDOOR / OUTDOOR RUN"
	WHEN 3000 THEN "OTHER"
	WHEN 52 THEN "INDOOR / OUTDOOR WALK"
	WHEN 20 THEN "FUNCTIONAL TRAINING"
	WHEN 13 THEN "INDOOR CYCLE"
	WHEN 16 THEN "ELLIPTICAL"
	WHEN 35 THEN "ROWER"
	ELSE "UNKNOWN" || "-" || WORKOUTS.ACTIVITY_TYPE
	END "WORKOUT TYPE",
	WORKOUTS.DURATION / 60.00 AS "DURATION (IN MINUTES)",
	WORKOUTS.TOTAL_ENERGY_BURNED AS "CALORIES BURNED",
	WORKOUTS.TOTAL_DISTANCE AS "DISTANCE IN KILOMETERS",
	WORKOUTS.TOTAL_BASAL_ENERGY_BURNED AS "TOTAL BASEL ENERGY BURNED",
	CASE WORKOUTS.GOAL_TYPE
	WHEN 2 THEN "MINUTES"
	WHEN 0 THEN "OPEN"
	END "GOAL TYPE",
	WORKOUTS.GOAL AS "GOAL",
	WORKOUTS.TOTAL_FLIGHTS_CLIMBED AS "FLIGHTS CLIMBED",
	WORKOUTS.TOTAL_W_STEPS AS "STEPS"
	FROM
	SAMPLES
	LEFT OUTER JOIN
	METADATA_VALUES
	ON METADATA_VALUES.OBJECT_ID = SAMPLES.DATA_ID
	LEFT OUTER JOIN
	METADATA_KEYS
	ON METADATA_KEYS.ROWID = METADATA_VALUES.KEY_ID
	LEFT OUTER JOIN
	WORKOUTS
	ON WORKOUTS.DATA_ID = SAMPLES.DATA_ID
	WHERE
	WORKOUTS.ACTIVITY_TYPE NOT NULL AND KEY IS "HKIndoorWorkout"

[FileParser.ios.locationd_cacheencryptedAB_celllocation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_celllocation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd Cell Location
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	MNC AS "MNC",
	LAC AS "LAC",
	CI AS "CI",
	UARFCN AS "UARFCN",
	PSC AS "PSC",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM CELLLOCATION

[FileParser.ios.sms_chat_message_read]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/sms_chat_message_read.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = SMS and Chat Messages, when the message was read.
query = 
	SELECT
	CASE
	WHEN LENGTH(MESSAGE.DATE)=18 THEN DATETIME(MESSAGE.DATE/1000000000+978307200,'UNIXEPOCH')
	WHEN LENGTH(MESSAGE.DATE)=9 THEN DATETIME(MESSAGE.DATE + 978307200,'UNIXEPOCH')
	ELSE "N/A"
	END "MESSAGE DATE",
	CASE
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=18 THEN DATETIME(MESSAGE.DATE_DELIVERED/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_DELIVERED)=9 THEN DATETIME(MESSAGE.DATE_DELIVERED+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE DELIVERED",
	CASE
	WHEN LENGTH(MESSAGE.DATE_READ)=18 THEN DATETIME(MESSAGE.DATE_READ/1000000000+978307200,"UNIXEPOCH")
	WHEN LENGTH(MESSAGE.DATE_READ)=9 THEN DATETIME(MESSAGE.DATE_READ+978307200,"UNIXEPOCH")
	ELSE "N/A"
	END "DATE READ",
	MESSAGE.TEXT as "MESSAGE",
	HANDLE.ID AS "CONTACT ID",
	MESSAGE.SERVICE AS "SERVICE",
	MESSAGE.ACCOUNT AS "ACCOUNT",
	MESSAGE.IS_DELIVERED AS "IS DELIVERED",
	MESSAGE.IS_FROM_ME AS "IS FROM ME",
	ATTACHMENT.FILENAME AS "FILENAME",
	ATTACHMENT.MIME_TYPE AS "MIME TYPE",
	ATTACHMENT.TRANSFER_NAME AS "TRANSFER TYPE",
	ATTACHMENT.TOTAL_BYTES AS "TOTAL BYTES"
	FROM MESSAGE
	LEFT OUTER JOIN MESSAGE_ATTACHMENT_JOIN ON MESSAGE.ROWID = MESSAGE_ATTACHMENT_JOIN.MESSAGE_ID
	LEFT OUTER JOIN ATTACHMENT ON MESSAGE_ATTACHMENT_JOIN.ATTACHMENT_ID = ATTACHMENT.ROWID
	LEFT OUTER JOIN HANDLE ON MESSAGE.HANDLE_ID = HANDLE.ROWID
	WHERE "DATE READ" IS NOT "N/A"

[FileParser.ios.powerlog_app_info]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_info.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Get a listing of applications and associated data (app name, executable name, bundle ID, app version, app type and deletion date/status). Not really a log per se, but a good listing of application information. App Types: 1="Background iOS Service", 3=iOS Native Apps, 4=3rd Party Apps
query = 
	SELECT
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	APPNAME AS "APP NAME",
	APPEXECUTABLE AS "APP EXECUTABLE NAME",
	APPBUNDLEID AS "BUNDLE ID",
	APPBUILDVERSION AS "APP BUILD VERSION",
	APPBUNDLEVERSION AS "APP BUNDLE VERSION",
	APPTYPE AS "APP TYPE",
	CASE APPDELETEDDATE
	WHEN 0 THEN "NOT DELETED"
	ELSE DATETIME(APPDELETEDDATE, 'unixepoch')
	END "APP DELETED DATE",
	ID AS "PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS TABLE ID"
	FROM
	PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS

[FileParser.ios.powerlog_app_deletion]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_app_deletion.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Applications that have been recently deleted.
query = 
	SELECT
	DATETIME(APPDELETEDDATE, 'unixepoch') AS "APP DELETED DATE",
	DATETIME(TIMESTAMP, 'unixepoch') AS TIMESTAMP,
	APPNAME AS "APP NAME",
	APPEXECUTABLE AS "APP EXECUTABLE NAME",
	APPBUNDLEID AS "BUNDLE ID",
	APPBUILDVERSION AS "APP BUILD VERSION",
	APPBUNDLEVERSION AS "APP BUNDLE VERSION",
	APPTYPE AS "APP TYPE",
	ID AS "PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS TABLE ID"
	FROM
	PLAPPLICATIONAGENT_EVENTNONE_ALLAPPS
	WHERE
	APPDELETEDDATE > 0

[FileParser.ios.aggregate_dictionary_scalars]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/aggregate_dictionary_scalars.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Keeping track of various values on a per-day basis.
query = 
	SELECT
	KEY AS "KEY",
	VALUE AS "VALUE",
	DATE(DAYSSINCE1970*86400, 'unixepoch') AS DAY
	FROM
	SCALARS

[FileParser.ios.locationd_cacheencryptedAB_ltecelllocation]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/locationd_cacheencryptedAB_ltecelllocation.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Locationd LTE Cell Location
query = 
	SELECT
	LATITUDE || ", " || LONGITUDE AS "COORDINATES",
	MCC AS "MCC",
	MNC AS "MNC",
	CI AS "CI",
	UARFCN AS "UARFCN",
	PID as "PID",
	ALTITUDE AS "ALTITUDE",
	SPEED AS "SPEED",
	COURSE AS "COURSE",
	CONFIDENCE AS "CONFIDENCE",
	HORIZONTALACCURACY AS "HORIZONTAL ACCURACY",
	VERTICALACCURACY AS "VERTICAL ACCURACY",
	LATITUDE AS "LATITUDE",
	LONGITUDE AS "LONGITUDE",
	DATETIME(TIMESTAMP + 978307200,'UNIXEPOCH') AS "TIMESTAMP"
	FROM LteCellLocation

[FileParser.ios.powerlog_accessory_connection]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/powerlog_accessory_connection.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Accessory Connections - Accessories may be bluetooth devices like headphones or connections to devices like CarPlay enabled vehicles.
query = 
	SELECT
	DATETIME(ACCESSORYCONNECTION_TIMESTAMP + SYSTEM, 'unixepoch') AS ADJUSTED_TIMESTAMP,
	ACCESSORYUSAGETIMEINSECONDS AS "ACCESSORY USAGE TIME IN SECONDS",
	DATETIME(IAPAPPACCESSORYCONNECTIONTIMEINSECKEY + SYSTEM, 'unixepoch') AS "CONNECTION TIME (ADJ)",
	CASE ISCONNECTED
	WHEN '0' THEN 'DISCONNECTED'
	WHEN '1' THEN 'CONNECTED'
	END "CONNECTION STATUS",
	DATETIME(TIME_OFFSET_TIMESTAMP, 'unixepoch') AS OFFSET_TIMESTAMP,
	SYSTEM AS TIME_OFFSET,
	ACCESSORYCONNECTION_ID AS "PLXPCAGENT_EVENTFORWARD_ACCESSORY TABLE ID"
	FROM
	(
	SELECT
	ACCESSORYCONNECTION_ID,
	ACCESSORYCONNECTION_TIMESTAMP,
	TIME_OFFSET_TIMESTAMP,
	MAX(TIME_OFFSET_ID) AS MAX_ID,
	ACCESSORYUSAGETIMEINSECONDS,
	IAPAPPACCESSORYCONNECTIONTIMEINSECKEY,
	ISCONNECTED,
	SYSTEM
	FROM
	(
	SELECT
	PLXPCAGENT_EVENTFORWARD_ACCESSORY.TIMESTAMP AS ACCESSORYCONNECTION_TIMESTAMP,
	ACCESSORYUSAGETIMEINSECONDS,
	IAPAPPACCESSORYCONNECTIONTIMEINSECKEY,
	ISCONNECTED,
	PLXPCAGENT_EVENTFORWARD_ACCESSORY.ID AS "ACCESSORYCONNECTION_ID" ,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.TIMESTAMP AS TIME_OFFSET_TIMESTAMP,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.ID AS TIME_OFFSET_ID,
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET.SYSTEM
	FROM
	PLXPCAGENT_EVENTFORWARD_ACCESSORY
	LEFT JOIN
	PLSTORAGEOPERATOR_EVENTFORWARD_TIMEOFFSET
	)
	AS ACCESSORYCONNECTION_STATE
	GROUP BY
	ACCESSORYCONNECTION_ID
	)

[FileParser.ios.routined_cloud_visit_outbound_stop]
modules = 
	base.output.CSVSink file_exists=OVERWRITE outfile="${ios.common:iosdir}/apollo/routined_cloud_visit_outbound_stop.csv"
	base.input.SQLiteReader
author = Sarah Edwards/mac4n6.com/@iamevltwin
notes = Significant Locations - Outbound Stop (Historical)
query = 
	SELECT
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTARTDATE + 978307200, 'unixepoch') AS "OUTBOUND START DATE",
	DATETIME(ZRTLEARNEDTRANSITIONMO.ZSTOPDATE + 978307200, 'unixepoch') AS "OUTBOUND STOP DATE",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE || ", " || ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "COORDINATES",
	ZRTLEARNEDVISITMO.ZPLACE AS "PLACE ID",
	ZRTLEARNEDVISITMO.ZDATAPOINTCOUNT AS "DATA POINT COUNT",
	ZRTLEARNEDVISITMO.ZLOCATIONUNCERTAINTY AS "LOCATION UNCERTAINTY",
	ZRTLEARNEDVISITMO.ZCONFIDENCE AS "CONFIDENCE",
	DATETIME(ZRTLEARNEDVISITMO.ZENTRYDATE + 978307200, 'unixepoch') AS "VISIT ENTRY",
	DATETIME(ZRTLEARNEDVISITMO.ZEXITDATE + 978307200, 'unixepoch') AS "VISIT EXIT",
	DATETIME(ZRTLEARNEDVISITMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "VISIT CREATION",
	DATETIME(ZRTLEARNEDVISITMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "VISIT EXPIRATION",
	ZRTDEVICEMO.ZDEVICECLASS AS "DEVICE CLASS",
	ZRTDEVICEMO.ZDEVICEMODEL AS "DEVICE MODEL",
	ZRTDEVICEMO.ZDEVICENAME AS "DEVICE NAME",
	DATETIME(ZRTLEARNEDPLACEMO.ZCREATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE CREATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZEXPIRATIONDATE + 978307200, 'unixepoch') AS "LEARNED PLACE EXPIRATION",
	DATETIME(ZRTLEARNEDPLACEMO.ZMAPITEMCREATIONDATE + 978307200, 'unixepoch') AS "MAP ITEM CREATION",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEMHANDLE) AS "PLACE NAME BLOB (HEX)",
	HEX(ZRTLEARNEDPLACEMO.ZMAPITEMGEOMAPITEM) AS "PLACE GEO BLOB (HEX)",
	ZRTLEARNEDVISITMO.ZLOCATIONLATITUDE AS "LATITUDE",
	ZRTLEARNEDVISITMO.ZLOCATIONLONGITUDE AS "LONGITUDE",
	ZRTLEARNEDVISITMO.Z_PK AS "ZRTLEARNEDVISITMO TABLE ID"
	FROM
	ZRTLEARNEDVISITMO
	LEFT JOIN
	ZRTDEVICEMO
	ON ZRTLEARNEDVISITMO.ZDEVICE = ZRTDEVICEMO.Z_PK
	LEFT JOIN
	ZRTLEARNEDPLACEMO
	ON ZRTLEARNEDPLACEMO.Z_PK = ZRTLEARNEDVISITMO.ZPLACE
	LEFT JOIN
	ZRTLEARNEDTRANSITIONMO
	ON ZRTLEARNEDTRANSITIONMO.Z_PK = ZRTLEARNEDVISITMO.ZOUTBOUND
	WHERE "OUTBOUND STOP DATE" NOT NULL

[ApolloProject.FileParser]
inherits = base.directory.FileParser
parsers = (.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_audio_routing
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_mobilebackup
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_app_calendar_activity
	(.*/Local.sqlite$$) FileParser.ios.routined_local_learned_location_of_interest_entry
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_heart_rate
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_entry
	(.*/CallHistory.storedata$$) FileParser.ios.call_history
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_batterylevel
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_audio_input_route
	(.*/sms.db$$) FileParser.ios.sms_chat_message_delivered
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_telephony_registration
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_locked
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_springboard_aggregate_bulletins
	(.*/Local.sqlite$$) FileParser.ios.routined_local_learned_location_of_interest_exit
	(.*/ADDataStore.sqlitedb$$) FileParser.ios.aggregate_dictionary_distributed_keys
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_display_brightness
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_elevation
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_incallservice
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_springboard_aggregate_notifications
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_battery_level
	(.*/DataUsage.sqlite$$)|(.*/DataUsage-watch.sqlite$$) FileParser.ios.datausage_zprocess
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_video
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_button_state
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_timezone
	(.*/History.db$$) FileParser.ios.safari_history
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_nowplaying
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_exit
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_app_inFocus
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_telephony_activity
	(.*/cache_encryptedC.db$$) FileParser.ios.locationd_cacheencryptedC_stepcounthistory
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_scdmacelllocation
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_is_backlit
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_process_data_usage
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_paired_device_config
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_usage
	(.*/netusage.sqlite$$) FileParser.ios.netusage_zliveusage
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_audio
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_flights
	(.*/interactionC.db$$) FileParser.ios.interaction_contact_interactions
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_app_activity
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_lock_state
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_location_client_status
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_camera_state
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_ids_messages
	(.*/passes23.sqlite$$) FileParser.ios.passes23_wallet_transactions
	(.*/Local.sqlite$$) FileParser.ios.routined_local_vehicle_parked
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_safari_browsing
	(.*/Local.sqlite$$) FileParser.ios.routined_local_learned_location_of_interest_transition_start
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_screen
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_audio_output_route
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_application_portrait
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_outbound_start
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_volume
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_location_latitude
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_celllocationlocal
	(.*/CoreRoutine.sqlite$$)|(.*/Cache.sqlite$$) FileParser.ios.routined_cache_zrtcllocationmo
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_app_intents
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_cdmacelllocation
	(.*/cache_encryptedC.db$$) FileParser.ios.locationd_cacheencryptedC_motionstatehistory
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_stood_up
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_usage_by_hour
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_weather
	(.*/cache_encryptedC.db$$) FileParser.ios.locationd_cacheencryptedC_nataliehistory
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_inbound_stop
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_torch_state
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_timezone
	(.*/DataUsage.sqlite$$)|(.*/DataUsage-watch.sqlite$$) FileParser.ios.datausage_zliveusage
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_ltecelllocationlocal
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_steps
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_push_message_received
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_lightnining_connector_status
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_timeofday
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_orientation
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_distance
	(.*/sms.db$$) FileParser.ios.sms_chat
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_device_screen_autolock
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_airdrop
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_battery_level_ui
	(.*/netusage.sqlite$$) FileParser.ios.netusage_zliverouteperf
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_weight
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_audio_media_nowplaying
	(.*/netusage.sqlite$$) FileParser.ios.netusage_zprocess
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_wallet_card
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_location_longitude
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_inbound_start
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_carplay_connected
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_pluggedin
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_bluetooth_device_state
	(.*/passes23.sqlite$$) FileParser.ios.passes23_wallet_passes
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_general
	(.*/Cache.sqlite$$)|(.*/CoreRoutine.sqlite$$) FileParser.ios.routined_cache_zrthintmo
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_temperature
	(.*/query_predictions.db$$) FileParser.ios.query_predictions
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_wallet_transaction
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_network_usage
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_location_tech_status
	(.*/Local.sqlite$$) FileParser.ios.routined_local_learned_location_of_interest_transition_stop
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_wifilocation
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_humidity
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_audio_bluetooth_connected
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_wifi_properties
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_device_watch_nearby
	(.*/knowledgeC.db$$) FileParser.ios.knowledge_app_install
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_volume_level
	(.*/Local.sqlite$$) FileParser.ios.routined_local_vehicle_parked_history
	(.*/healthdb_secure.sqlite$$) FileParser.ios.health_workout_indoor
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_celllocation
	(.*/sms.db$$) FileParser.ios.sms_chat_message_read
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_info
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_app_deletion
	(.*/ADDataStore.sqlitedb$$) FileParser.ios.aggregate_dictionary_scalars
	(.*/cache_encryptedB.db$$)|(.*/cache_encryptedA.db$$)|(.*/lockCache_encryptedA.db$$) FileParser.ios.locationd_cacheencryptedAB_ltecelllocation
	(.*/CurrentPowerlog.PLSQL$$) FileParser.ios.powerlog_accessory_connection
	(.*/Cloud.sqlite$$) FileParser.ios.routined_cloud_visit_outbound_stop

